(herald "5G AKA Round 1 suci "
  (comment "First attempt for modeling 5G AKA"))

(comment "CPSA 3.6.6")
(comment "All input read from 5g_aka_test.scm")

(defprotocol AKA5G basic
  (defrole UserEquip
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN) SQN)
    (uniq-gen n)
    (fn-of ("ID" (SUPI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig (ltk SN HN))
    (fn-of ("ID" (SUPI (cat UE HN)))))
  (defrole HomeNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
    (uniq-gen RAND)
    (fn-of ("ID" (SUPI (cat UE HN))))))

(defskeleton AKA5G
  (vars (SQN text) (SUPI n RAND data) (UE SN HN name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN))
  (uniq-gen n)
  (traces
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 0)
  (unrealized (0 1))
  (origs)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (SUPI n RAND n-0 data) (UE SN HN SN-0 name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (precedes ((1 1) (0 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN-0 HN) (privk HN))
  (uniq-gen n RAND)
  (operation encryption-test (added-strand HomeNetwork 2)
    (hash SQN (hash (ltk UE HN) RAND)) (0 1))
  (traces
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN)))))
  (label 1)
  (parent 0)
  (unrealized (0 1) (1 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (SUPI n RAND n-0 data) (UE SN HN SN-0 name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN-0) (HN HN))
  (precedes ((1 1) (0 1)) ((2 1) (1 0)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN-0 HN) (privk HN))
  (uniq-gen n RAND)
  (operation encryption-test (added-strand ServingNetwork 2)
    (enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN)) (1 0))
  (traces
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN)))))
  (label 2)
  (parent 1)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (n RAND SUPI n-0 data) (UE SN HN SN-0 name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (precedes ((1 1) (2 2)) ((2 1) (1 0)) ((2 3) (0 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN-0 HN) (privk HN))
  (uniq-gen n RAND)
  (operation encryption-test (displaced 2 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (0 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN)))
  (traces
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 3)
  (parent 2)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (n n) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (RAND RAND))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (SUPI n RAND n-0 n-1 data) (UE SN HN SN-0 name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN-0) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN-0) (HN HN))
  (precedes ((1 1) (3 2)) ((2 1) (1 0)) ((3 3) (0 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN-0 HN) (privk HN))
  (uniq-gen n RAND)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (0 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN)))
  (traces
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN-0 (ltk SN-0 HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 4)
  (parent 2)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (n n) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (RAND RAND))))
  (origs))

(comment "Nothing left to do")

(defprotocol AKA5G basic
  (defrole UserEquip
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN) SQN)
    (uniq-gen n)
    (fn-of ("ID" (SUPI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig (ltk SN HN))
    (fn-of ("ID" (SUPI (cat UE HN)))))
  (defrole HomeNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
    (uniq-gen RAND)
    (fn-of ("ID" (SUPI (cat UE HN))))))

(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig (ltk SN HN))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 5)
  (unrealized (0 2) (0 6))
  (origs)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand HomeNetwork 2)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (0 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))))
  (label 6)
  (parent 5)
  (unrealized (0 4) (0 6) (1 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 2 0 ServingNetwork 2)
    (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)) (1 0))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))))
  (label 7)
  (parent 6)
  (unrealized (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((2 1) (1 0)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 2)
    (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)) (1 0))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))))
  (label 8)
  (parent 6)
  (unrealized (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (2 1)) ((2 2) (0 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (0 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 9)
  (parent 7)
  (unrealized (0 6) (2 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (2 0)) ((2 1) (0 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (0 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 10)
  (parent 7)
  (unrealized (0 6) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (3 1)) ((2 1) (1 0)) ((3 2) (0 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (0 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-1 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 11)
  (parent 8)
  (unrealized (0 6) (3 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 1) (0 2)) ((1 1) (3 0)) ((2 1) (1 0)) ((3 1) (0 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (0 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 12)
  (parent 8)
  (unrealized (0 6) (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (2 1)) ((2 2) (0 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 1 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (2 1))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 13)
  (parent 9)
  (unrealized (0 6) (2 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (3 1)) ((2 1) (1 0)) ((3 2) (0 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (displaced 4 1 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (3 1))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-1 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 14)
  (parent 11)
  (unrealized (0 6) (3 1))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((0 3) (2 1)) ((1 1) (0 2)) ((2 2) (0 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 15)
  (parent 13)
  (unrealized (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (3 2)) ((2 2) (0 4))
    ((3 3) (2 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 16)
  (parent 13)
  (unrealized (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (3 1)) ((1 1) (0 2)) ((2 1) (1 0)) ((3 2) (0 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (displaced 4 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-1 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 17)
  (parent 14)
  (unrealized (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (3 2)) ((2 2) (0 4)) ((3 1) (1 0))
    ((3 3) (2 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 2 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 18)
  (parent 14)
  (unrealized (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (4 2)) ((2 1) (1 0)) ((3 2) (0 4))
    ((4 3) (3 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-1 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 19)
  (parent 14)
  (unrealized (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 1 3 HomeNetwork 4)
    (enc "Success"
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 20)
  (parent 15)
  (unrealized (2 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 1 4 HomeNetwork 4)
    (enc "Success"
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 21)
  (parent 16)
  (unrealized (3 2))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 4 HomeNetwork 4)
    (enc "Success"
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 22)
  (parent 17)
  (unrealized (3 2))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 4 HomeNetwork 4)
    (enc "Success"
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 23)
  (parent 18)
  (unrealized (3 2))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 5 HomeNetwork 4)
    (enc "Success"
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 24)
  (parent 19)
  (unrealized (4 2))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((0 5) (2 2)) ((1 2) (0 4))
    ((2 1) (0 2)) ((2 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 3 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (2 2))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 25)
  (parent 20)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-1) (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (2 2))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN-0 (hash (ltk UE HN) RAND))
            (hash SQN-0 RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 26)
  (parent 20)
  (unrealized (3 2) (3 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((0 5) (3 2)) ((1 2) (0 4)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 4 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 27)
  (parent 21)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 2 4 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 28)
  (parent 21)
  (unrealized (3 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-2) (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN-0 (hash (ltk UE HN) RAND))
            (hash SQN-0 RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 29)
  (parent 21)
  (unrealized (4 2) (4 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((0 5) (3 2)) ((1 1) (3 0)) ((2 2) (0 4))
    ((3 1) (0 2)) ((3 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 30)
  (parent 22)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-1) (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 4 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN-0 (hash (ltk UE HN) RAND))
            (hash SQN-0 RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 31)
  (parent 22)
  (unrealized (3 2) (3 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-2) (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN-0 (hash (ltk UE HN) RAND))
            (hash SQN-0 RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 32)
  (parent 22)
  (unrealized (4 2) (4 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 5) (3 2)) ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 33)
  (parent 23)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 3) (0 6))
    ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 2 4 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 34)
  (parent 23)
  (unrealized (3 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-2) (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN-0 (hash (ltk UE HN) RAND))
            (hash SQN-0 RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 35)
  (parent 23)
  (unrealized (4 2) (4 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 5) (4 2)) ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1))
    ((4 1) (0 2)) ((4 1) (3 2)) ((4 3) (0 6)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (4 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 36)
  (parent 24)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-2) (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 5 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (4 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN-0 (hash (ltk UE HN) RAND))
            (hash SQN-0 RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 37)
  (parent 24)
  (unrealized (4 2) (4 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 5 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (4 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 38)
  (parent 24)
  (unrealized (4 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-3) (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6)) ((5 5) (4 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (4 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN-0 (hash (ltk UE HN) RAND))
            (hash SQN-0 RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 39)
  (parent 24)
  (unrealized (5 2) (5 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 4 2 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 40)
  (parent 26)
  (unrealized (3 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((1 2) (3 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 4 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 41)
  (parent 28)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 1)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 42)
  (parent 28)
  (unrealized (4 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 0)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 1) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 43)
  (parent 28)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 5 3 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (4 2))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 44)
  (parent 29)
  (unrealized (4 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 2 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (3 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 45)
  (parent 31)
  (unrealized (3 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 3 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (4 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 46)
  (parent 32)
  (unrealized (4 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((1 2) (3 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 47)
  (parent 34)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (4 1))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 48)
  (parent 34)
  (unrealized (4 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (4 0))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 1) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 49)
  (parent 34)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 3 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (4 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 50)
  (parent 35)
  (unrealized (4 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 3 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (4 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 51)
  (parent 37)
  (unrealized (4 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((2 2) (4 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 2 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 52)
  (parent 38)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 n-1 SUPI n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 1) (5 1)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 53)
  (parent 38)
  (unrealized (5 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 1) (5 0)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 1) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 54)
  (parent 38)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6)) ((5 5) (4 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 6 4 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (5 2))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 55)
  (parent 39)
  (unrealized (5 4))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((1 2) (3 4))
    ((2 1) (0 2)) ((2 1) (3 2)) ((2 3) (0 6)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 4 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 56)
  (parent 40)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 1) (4 1)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 57)
  (parent 40)
  (unrealized (4 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 1) (4 0)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 1) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 58)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 1)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 2 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (4 1))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 59)
  (parent 42)
  (unrealized (4 1))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((1 2) (4 4)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 5 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 60)
  (parent 44)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 n-1 n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 61)
  (parent 44)
  (unrealized (5 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 0)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 1) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 62)
  (parent 44)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((1 2) (3 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 63)
  (parent 45)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 1)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 64)
  (parent 45)
  (unrealized (4 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 0)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 1) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 65)
  (parent 45)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((2 2) (4 4))
    ((3 1) (0 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 2 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 66)
  (parent 46)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 67)
  (parent 46)
  (unrealized (5 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 1) (5 0)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 1) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 68)
  (parent 46)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (4 1))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 2 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (4 1))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 69)
  (parent 48)
  (unrealized (4 1))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((1 2) (4 4)) ((2 1) (3 0)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 70)
  (parent 50)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 71)
  (parent 50)
  (unrealized (5 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 0)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 1) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 72)
  (parent 50)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((1 2) (4 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 73)
  (parent 51)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 n-1 SUPI n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 74)
  (parent 51)
  (unrealized (5 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (5 0)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 1) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 75)
  (parent 51)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 1) (5 1)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 76)
  (parent 53)
  (unrealized (5 1))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((2 2) (5 4)) ((3 3) (2 1))
    ((4 1) (0 2)) ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6))
    ((5 5) (4 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 6 2 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (5 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 77)
  (parent 55)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 1) (6 1)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (5 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-4 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 78)
  (parent 55)
  (unrealized (6 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 1) (6 0)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 1) (5 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (5 4))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 79)
  (parent 55)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 1) (4 1)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 2 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (4 1))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 80)
  (parent 57)
  (unrealized (4 1))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (4 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 81)
  (parent 59)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 3) (1 1)) ((3 3) (4 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 82)
  (parent 59)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (5 2)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)) ((5 3) (4 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 83)
  (parent 59)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 84)
  (parent 61)
  (unrealized (5 1))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 1)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 2 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (4 1))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 85)
  (parent 64)
  (unrealized (4 1))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 86)
  (parent 67)
  (unrealized (5 1))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (4 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 87)
  (parent 69)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 3) (0 6))
    ((3 1) (2 0)) ((3 3) (1 1)) ((3 3) (4 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 88)
  (parent 69)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (5 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)) ((5 3) (4 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 89)
  (parent 69)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 90)
  (parent 71)
  (unrealized (5 1))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 91)
  (parent 74)
  (unrealized (5 1))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (5 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 92)
  (parent 76)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 n-2 SUPI n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (5 2))
    ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2)) ((4 2) (3 4))
    ((5 1) (2 0)) ((5 3) (4 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 1 6 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 93)
  (parent 76)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 3) (0 6)) ((4 3) (2 1)) ((4 3) (5 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 94)
  (parent 76)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 1) (6 2)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-4 (pubk HN)))
      (send (enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 95)
  (parent 76)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 1) (6 1)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (displaced 7 4 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (6 1))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-4 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 96)
  (parent 78)
  (unrealized (6 1))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((0 3) (4 1)) ((1 2) (0 4))
    ((2 1) (0 2)) ((2 1) (3 2)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 97)
  (parent 80)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 3) (4 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 98)
  (parent 80)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 1) (5 2)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 2) (3 4)) ((5 3) (4 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 99)
  (parent 80)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((0 3) (5 1)) ((1 2) (0 4)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 100)
  (parent 84)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((2 3) (5 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (displaced 6 2 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 101)
  (parent 84)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (5 1))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 102)
  (parent 84)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-4 (pubk HN)))
      (send (enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 103)
  (parent 84)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((0 3) (4 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 104)
  (parent 85)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (4 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 105)
  (parent 85)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (5 2)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 2) (3 4)) ((5 3) (4 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 106)
  (parent 85)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((0 3) (5 1)) ((1 1) (3 0)) ((2 2) (0 4))
    ((3 1) (0 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 107)
  (parent 86)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 n-2 SUPI n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (5 2)) ((2 3) (0 6)) ((3 5) (2 2)) ((4 2) (3 4))
    ((5 1) (2 0)) ((5 3) (4 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 1 6 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-2 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 108)
  (parent 86)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (5 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 109)
  (parent 86)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-4 (pubk HN)))
      (send (enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 110)
  (parent 86)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (5 1)) ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 111)
  (parent 90)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((2 3) (5 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 2 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 112)
  (parent 90)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (5 1))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 113)
  (parent 90)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-4 (pubk HN)))
      (send (enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 114)
  (parent 90)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (5 1)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 115)
  (parent 91)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((2 3) (5 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 2 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 116)
  (parent 91)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0)) ((4 3) (5 1))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 117)
  (parent 91)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-4 (pubk HN)))
      (send (enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 118)
  (parent 91)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (6 1)) ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1))
    ((4 1) (0 2)) ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (displaced 7 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-4 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 119)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 n-2 n-3 SUPI n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)) ((6 1) (3 0)) ((6 3) (5 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 1 7 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-3 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-4 (pubk HN)))
      (send (enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 120)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((3 3) (6 1))
    ((4 1) (0 2)) ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (displaced 7 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-4 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 121)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6)) ((5 3) (6 1))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (displaced 7 5 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-4 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 122)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 n-5 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-5)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 1) (7 2)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)) ((7 3) (6 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN)))))
    ((recv (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n-3 (pubk HN)))
      (send (enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-4 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-5 (pubk HN)))
      (send (enc (enc SUPI n-5 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 123)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))

(comment "Nothing left to do")

(defprotocol AKA5G basic
  (defrole UserEquip
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN) SQN)
    (uniq-gen n)
    (fn-of ("ID" (SUPI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig (ltk SN HN))
    (fn-of ("ID" (SUPI (cat UE HN)))))
  (defrole HomeNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
    (uniq-gen RAND)
    (fn-of ("ID" (SUPI (cat UE HN))))))

(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN)))))
  (label 124)
  (unrealized (0 0) (0 2))
  (origs)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (precedes ((1 1) (0 0)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 2)
    (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)) (0 0))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))))
  (label 125)
  (parent 124)
  (unrealized (0 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((1 1) (0 0)) ((1 5) (0 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 1 2 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (0 2))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN-0 (hash (ltk UE HN) RAND))
            (hash SQN-0 RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 126)
  (parent 125)
  (unrealized (1 2) (1 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (SUPI RAND n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-0) (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((1 1) (0 0)) ((2 5) (0 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (0 2))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN-0 (hash (ltk UE HN) RAND))
            (hash SQN-0 RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 127)
  (parent 125)
  (unrealized (2 2) (2 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((1 1) (0 0)) ((1 5) (0 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 2 0 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (1 2))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 128)
  (parent 126)
  (unrealized (1 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((1 1) (0 0)) ((2 5) (0 2)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 3 0 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (2 2))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))))
  (label 129)
  (parent 127)
  (unrealized (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((0 1) (2 1)) ((1 1) (0 0)) ((1 5) (0 2))
    ((2 2) (1 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (1 4))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 130)
  (parent 128)
  (unrealized (2 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (1 2)) ((0 1) (2 0)) ((1 1) (0 0)) ((1 5) (0 2))
    ((2 1) (1 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (1 4))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 131)
  (parent 128)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN SQN-0 text) (SUPI RAND n n-0 n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((0 1) (3 1)) ((1 1) (0 0)) ((2 5) (0 2))
    ((3 2) (2 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (2 4))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-1 (pubk HN)))
      (recv
        (cat RAND (hash SQN-0 (hash (ltk UE HN) RAND))
          (hash SQN-0 RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 132)
  (parent 129)
  (unrealized (3 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (2 2)) ((0 1) (3 0)) ((1 1) (0 0)) ((2 5) (0 2))
    ((3 1) (2 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (2 4))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((recv
       (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
         RAND (hash (ltk UE HN) RAND)))
      (send
        (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 133)
  (parent 129)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((0 1) (2 1)) ((1 1) (0 0)) ((1 5) (0 2))
    ((2 2) (1 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 0 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (2 1))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 134)
  (parent 130)
  (unrealized (2 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((0 1) (3 1)) ((1 1) (0 0)) ((2 5) (0 2))
    ((3 2) (2 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (displaced 4 0 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (3 1))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-1 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 135)
  (parent 132)
  (unrealized (3 1))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((1 1) (0 0)) ((1 3) (2 1)) ((1 5) (0 2))
    ((2 2) (1 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 1 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 136)
  (parent 134)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((0 1) (3 2)) ((1 1) (0 0)) ((1 5) (0 2))
    ((2 2) (1 4)) ((3 3) (2 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 137)
  (parent 134)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((0 1) (3 2)) ((1 5) (0 2)) ((2 2) (1 4))
    ((3 1) (0 0)) ((3 3) (2 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-0 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-1 (pubk HN)))
      (send (enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 138)
  (parent 135)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n-1))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((1 1) (0 0)) ((2 3) (3 1)) ((2 5) (0 2))
    ((3 2) (2 4)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (displaced 4 2 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-1 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))))
  (label 139)
  (parent 135)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n))))
  (origs))

(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 n-1 n-2 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((0 1) (4 2)) ((1 1) (0 0)) ((2 5) (0 2))
    ((3 2) (2 4)) ((4 3) (3 1)))
  (fn-of ("ID" (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (traces
    ((recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc "Success"
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    ((recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN))))
    ((recv (enc SUPI n-0 (pubk HN)))
      (send (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN))))
    ((send (enc SUPI n-1 (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    ((recv (enc SUPI n-2 (pubk HN)))
      (send (enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))))
  (label 140)
  (parent 135)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n))))
  (origs))

(comment "Nothing left to do")
