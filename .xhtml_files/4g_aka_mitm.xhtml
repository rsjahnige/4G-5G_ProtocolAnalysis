<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>4G AKA SUCI</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;4G AKA SUCI&quot; (comment &quot;First attempt for modeling 4G ePs-AKA&quot;))
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from 4g_aka_mitm.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t15">15</a> <a href="#t34">34</a>.</p>

<p id="t0">Tree <a href="#top">0</a>.</p>

<div>
 <svg
  class='diagram' width='229.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 229.680 754.920' font-size='12.000'>
  <text
   x='89.880' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='89.880' y1='564.960' x2='139.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol AKA4G basic
  (defrole malSN
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (recv IMSI)
      (send
        (cat RAND (enc SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND)))
      (send
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND))))
    (deflistener IMSI)
    (deflistener (cat RAND (AUTH SQN RAND (ltk UE HN)))))
  (defrole UserEquip
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (send IMSI)
      (recv
        (cat RAND (enc SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN))
    (fn-of (&quot;ID&quot; (IMSI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (recv IMSI) (send (enc IMSI SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (enc SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
            (hash (ltk UE HN) RAND))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
            (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
      (send
        (cat RAND (enc SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND))))
    (non-orig (ltk SN HN)))
  (defrole HomeNetwork
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (recv (enc IMSI SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (enc SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
            (hash (ltk UE HN) RAND))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
            (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))))
    (non-orig (ltk SN HN) (ltk UE HN))
    (uniq-gen RAND)
    (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Children: <a href="#k1">1</a> <a href="#k2">2</a> <a href="#k3">3</a> <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND-0 (enc SQN-0 (hash (ltk UE-0 HN-0) RAND-0)) (hash SQN-0 RAND-0 (ltk UE-0 HN-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN-0) (RAND RAND-0) (UE UE-0) (SN SN-0) (HN HN-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA4G 0</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 RAND-0 data)
    (UE SN HN UE-0 SN-0 HN-0 name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN-0) (RAND RAND-0) (UE UE-0)
    (SN SN-0) (HN HN-0))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (label 0)
  (unrealized (0 1))
  (origs)
  (comment &quot;4 in cohort - 4 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Children: <a href="#k5">5</a> <a href="#k6">6</a> <a href="#k7">7</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA4G 1</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN UE SN-0 HN name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (precedes ((1 1) (0 1)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (operation encryption-test (displaced 2 1 malSN 2)
    (enc SQN-0 (hash (ltk UE-0 HN-0) RAND-0)) (0 1))
  (label 1)
  (parent 0)
  (unrealized (1 2))
  (origs)
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-1</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND-0 (enc SQN-0 (hash (ltk UE-0 HN-0) RAND-0)) (hash SQN-0 RAND-0 (ltk UE-0 HN-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-1) (SQN SQN) (RAND RAND) (UE UE) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN-0) (RAND RAND-0) (UE UE-0) (SN SN-0) (HN HN-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>AKA4G 2 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 IMSI-1 text) (SQN RAND SQN-0 RAND-0 data)
    (UE SN HN UE-0 SN-0 HN-0 name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN-0) (RAND RAND-0) (UE UE-0)
    (SN SN-0) (HN HN-0))
  (defstrand malSN 2 (IMSI IMSI-1) (SQN SQN) (RAND RAND) (UE UE)
    (HN HN))
  (precedes ((2 1) (0 1)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (operation encryption-test (added-strand malSN 2)
    (enc SQN (hash (ltk UE HN) RAND)) (0 1))
  (label 2)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((SQN SQN) (UE UE) (SN SN) (HN HN) (IMSI IMSI) (RAND RAND)
        (SQN-0 SQN-0) (RAND-0 RAND-0) (UE-0 UE-0) (SN-0 SN-0)
        (HN-0 HN-0) (IMSI-0 IMSI-0))))
  (origs))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN-1 (ltk SN-1 HN))</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND-0 (enc SQN-0 (hash (ltk UE-0 HN-0) RAND-0)) (hash SQN-0 RAND-0 (ltk UE-0 HN-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='39.960' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-1) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0) (SN SN-0) (HN HN-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA4G 3</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 RAND-0 data)
    (UE SN HN UE-0 SN-0 HN-0 SN-1 name))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0)
    (SN SN-0) (HN HN-0))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-1) (HN HN))
  (precedes ((2 1) (0 1)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk UE HN) (ltk SN-1 HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand HomeNetwork 2)
    (enc SQN (hash (ltk UE HN) RAND)) (0 1))
  (label 3)
  (parent 0)
  (unrealized (0 1) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND-0 (enc SQN-0 (hash (ltk UE-0 HN-0) RAND-0)) (hash SQN-0 RAND-0 (ltk UE-0 HN-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN-0) (RAND RAND-0) (UE UE-0) (SN SN-0) (HN HN-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA4G 4</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 RAND-0 data)
    (UE SN HN UE-0 SN-0 HN-0 name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN-0) (RAND RAND-0) (UE UE-0)
    (SN SN-0) (HN HN-0))
  (deflistener (hash (ltk UE HN) RAND))
  (precedes ((2 1) (0 1)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (operation encryption-test (added-listener (hash (ltk UE HN) RAND))
    (enc SQN (hash (ltk UE HN) RAND)) (0 1))
  (label 4)
  (parent 0)
  (unrealized (0 1) (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>AKA4G 5 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN UE HN name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN)
    (HN HN))
  (precedes ((0 2) (1 2)) ((1 1) (0 1)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (operation encryption-test (displaced 2 0 UserEquip 3)
    (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND
      (hash (ltk UE HN) RAND)) (1 2))
  (label 5)
  (parent 1)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((SQN SQN) (UE UE) (SN SN) (HN HN) (IMSI IMSI) (RAND RAND)
        (SQN-0 SQN) (RAND-0 RAND) (UE-0 UE) (SN-0 SN) (HN-0 HN)
        (IMSI-0 IMSI-0))))
  (origs))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k9">9</a> <a href="#k10">10</a> <a href="#k11">11</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA4G 6</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 data) (SN UE SN-0 HN name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (precedes ((1 1) (0 1)) ((2 2) (1 2)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (operation encryption-test (added-strand UserEquip 3)
    (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND
      (hash (ltk UE HN) RAND)) (1 2))
  (label 6)
  (parent 1)
  (unrealized (2 1))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.300 225.660 144.719 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA4G 7</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN UE SN-0 HN name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (deflistener
    (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 1) (0 1)) ((2 1) (1 2)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (operation encryption-test
    (added-listener
      (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND
        (hash (ltk UE HN) RAND)))
    (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND
      (hash (ltk UE HN) RAND)) (1 2))
  (label 7)
  (parent 1)
  (unrealized (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k3">3</a>, Children: <a href="#k12">12</a> <a href="#k13">13</a> <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN-1 (ltk SN-1 HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN-1 (ltk SN-1 HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND-0 (enc SQN-0 (hash (ltk UE-0 HN-0) RAND-0)) (hash SQN-0 RAND-0 (ltk UE-0 HN-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>((IMSI IMSI-0) (SN SN-1) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-1) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0) (SN SN-0) (HN HN-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA4G 8</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 RAND-0 data)
    (UE SN HN UE-0 SN-0 HN-0 SN-1 name))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0)
    (SN SN-0) (HN HN-0))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-1) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN-1) (HN HN))
  (precedes ((2 1) (0 1)) ((3 1) (2 0)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk UE HN) (ltk SN-1 HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 2)
    (enc IMSI-0 SN-1 (ltk SN-1 HN)) (2 0))
  (label 8)
  (parent 3)
  (unrealized (0 1))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k9">Item <a href="#t0">9</a>, Parent: <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>AKA4G 9 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN UE SN-0 HN name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (precedes ((1 1) (0 1)) ((1 1) (2 1)) ((2 2) (1 2)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (operation encryption-test (displaced 3 1 malSN 2)
    (enc SQN-0 (hash (ltk UE HN) RAND)) (2 1))
  (label 9)
  (parent 6)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((SQN SQN) (UE UE) (SN SN) (HN HN) (IMSI IMSI) (RAND RAND)
        (SQN-0 SQN) (RAND-0 RAND) (UE-0 UE) (SN-0 SN-0) (HN-0 HN)
        (IMSI-0 IMSI-0))))
  (origs))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-1</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-1) (SQN SQN-0) (RAND RAND) (UE UE) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA4G 10 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 IMSI-1 text) (SQN RAND SQN-0 data)
    (SN UE SN-0 HN name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (defstrand malSN 2 (IMSI IMSI-1) (SQN SQN-0) (RAND RAND) (UE UE)
    (HN HN))
  (precedes ((1 1) (0 1)) ((2 2) (1 2)) ((3 1) (2 1)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (operation encryption-test (added-strand malSN 2)
    (enc SQN-0 (hash (ltk UE HN) RAND)) (2 1))
  (label 10)
  (parent 6)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((SQN SQN) (UE UE) (SN SN) (HN HN) (IMSI IMSI) (RAND RAND)
        (SQN-0 SQN) (RAND-0 RAND) (UE-0 UE) (SN-0 SN-0) (HN-0 HN)
        (IMSI-0 IMSI-0))))
  (origs))</pre>

<p id="k11">Item <a href="#t0">11</a>, Parent: <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-0 RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA4G 11</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 data) (SN UE SN-0 HN name))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (deflistener (hash (ltk UE HN) RAND))
  (precedes ((1 1) (0 1)) ((2 2) (1 2)) ((3 1) (2 1)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN))
  (operation encryption-test (added-listener (hash (ltk UE HN) RAND))
    (enc SQN-0 (hash (ltk UE HN) RAND)) (2 1))
  (label 11)
  (parent 6)
  (unrealized (2 1) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN-1 (ltk SN-1 HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN-1 (ltk SN-1 HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND-0 (enc SQN-0 (hash (ltk UE-0 HN-0) RAND-0)) (hash SQN-0 RAND-0 (ltk UE-0 HN-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='39.960' cy='264.960' r='6.000'/>
   </g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-1) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-1) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0) (SN SN-0) (HN HN-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA4G 12 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 RAND-0 data)
    (UE SN HN UE-0 SN-0 HN-0 SN-1 name))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0)
    (SN SN-0) (HN HN-0))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-1) (HN HN))
  (defstrand ServingNetwork 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND)
    (UE UE) (SN SN-1) (HN HN))
  (precedes ((2 1) (3 2)) ((3 1) (2 0)) ((3 3) (0 1)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk UE HN) (ltk SN-1 HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 3 4 ServingNetwork 4)
    (enc SQN (hash (ltk UE HN) RAND)) (0 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN)))
  (label 12)
  (parent 8)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((SQN SQN) (UE UE) (SN SN) (HN HN) (IMSI IMSI-0) (RAND RAND)
        (SQN-0 SQN-0) (RAND-0 RAND-0) (UE-0 UE-0) (SN-0 SN-0)
        (HN-0 HN-0) (IMSI-0 IMSI))))
  (origs))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 242.880 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-1 SN-1 (ltk SN-1 HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-1</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN-1 (ltk SN-1 HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN-1 (ltk SN-1 HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND-0 (enc SQN-0 (hash (ltk UE-0 HN-0) RAND-0)) (hash SQN-0 RAND-0 (ltk UE-0 HN-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='39.960' cy='264.960' r='6.000'/>
   </g>
  <g>
   <title>((IMSI IMSI-1) (SQN SQN) (RAND RAND) (UE UE) (SN SN-1) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g><title>((IMSI IMSI-0) (SN SN-1) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-1) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0) (SN SN-0) (HN HN-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA4G 13 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 IMSI-1 text) (SQN RAND SQN-0 RAND-0 data)
    (UE SN HN UE-0 SN-0 HN-0 SN-1 name))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0)
    (SN SN-0) (HN HN-0))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-1) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN-1) (HN HN))
  (defstrand ServingNetwork 4 (IMSI IMSI-1) (SQN SQN) (RAND RAND)
    (UE UE) (SN SN-1) (HN HN))
  (precedes ((2 1) (4 2)) ((3 1) (2 0)) ((4 3) (0 1)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk UE HN) (ltk SN-1 HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 4)
    (enc SQN (hash (ltk UE HN) RAND)) (0 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN)))
  (label 13)
  (parent 8)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((SQN SQN) (UE UE) (SN SN) (HN HN) (IMSI IMSI-0) (RAND RAND)
        (SQN-0 SQN-0) (RAND-0 RAND-0) (UE-0 UE-0) (SN-0 SN-0)
        (HN-0 HN-0) (IMSI-0 IMSI))))
  (origs))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 242.880 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN-1 (ltk SN-1 HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN-1 (ltk SN-1 HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE-0 HN-0) RAND-0) (hash (ltk UE-0 HN-0) RAND-0) SN-0 RAND-0 (hash (ltk UE-0 HN-0) RAND-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND-0 (enc SQN-0 (hash (ltk UE-0 HN-0) RAND-0)) (hash SQN-0 RAND-0 (ltk UE-0 HN-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='39.960' cy='264.960' r='6.000'/>
   </g>
  <g><title>((IMSI IMSI-0) (SN SN-1) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN-1) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0) (SN SN-0) (HN HN-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>malSN</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA4G 14</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 RAND-0 data)
    (UE SN HN UE-0 SN-0 HN-0 SN-1 name))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand malSN 4 (IMSI IMSI) (SQN SQN-0) (RAND RAND-0) (UE UE-0)
    (SN SN-0) (HN HN-0))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN-1) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN-1) (HN HN))
  (deflistener (hash (ltk UE HN) RAND))
  (precedes ((2 1) (4 0)) ((3 1) (2 0)) ((4 1) (0 1)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk UE HN) (ltk SN-1 HN))
  (uniq-gen RAND)
  (operation encryption-test (added-listener (hash (ltk UE HN) RAND))
    (enc SQN (hash (ltk UE HN) RAND)) (0 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1 RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN-1
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN-1 HN)))
  (label 14)
  (parent 8)
  (unrealized (0 1) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t15">Tree <a href="#top">15</a>.</p>

<div>
 <svg
  class='diagram' width='329.520pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 329.520 829.920' font-size='12.000'>
  <text
   x='189.720' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='139.800' y1='602.460' x2='189.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  <line
   x1='189.720' y1='564.960' x2='239.640' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='189.720' y1='564.960' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='139.800' y1='602.460' x2='189.720' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='588.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  <line
   x1='89.880' y1='414.960' x2='139.800' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='189.720' y1='152.460' x2='239.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='189.720' y1='152.460' x2='239.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='138.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='89.880' y1='414.960' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='39.960' y1='414.960' x2='89.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  </svg></div>

<pre>(defprotocol AKA4G basic
  (defrole malSN
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (recv IMSI)
      (send
        (cat RAND (enc SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND)))
      (send
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND))))
    (deflistener IMSI)
    (deflistener (cat RAND (AUTH SQN RAND (ltk UE HN)))))
  (defrole UserEquip
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (send IMSI)
      (recv
        (cat RAND (enc SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN))
    (fn-of (&quot;ID&quot; (IMSI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (recv IMSI) (send (enc IMSI SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (enc SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
            (hash (ltk UE HN) RAND))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
            (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
      (send
        (cat RAND (enc SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND))))
    (non-orig (ltk SN HN)))
  (defrole HomeNetwork
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (recv (enc IMSI SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (enc SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
            (hash (ltk UE HN) RAND))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
            (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))))
    (non-orig (ltk SN HN) (ltk UE HN))
    (uniq-gen RAND)
    (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))))</pre>

<p id="k15">Item <a href="#t15">15</a>, Child: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>AKA4G 15</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (non-orig (ltk SN HN))
  (label 15)
  (unrealized (0 2))
  (origs)
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k16">Item <a href="#t15">16</a>, Parent: <a href="#k15">15</a>, Children: <a href="#k17">17</a> <a href="#k18">18</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: red;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA4G 16</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (precedes ((1 1) (0 2)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand HomeNetwork 2)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)) (0 2))
  (label 16)
  (parent 15)
  (unrealized (0 4) (1 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k17">Item <a href="#t15">17</a>, Parent: <a href="#k16">16</a>, Children: <a href="#k19">19</a> <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA4G 17</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 2 0 ServingNetwork 2)
    (enc IMSI-0 SN (ltk SN HN)) (1 0))
  (label 17)
  (parent 16)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k18">Item <a href="#t15">18</a>, Parent: <a href="#k16">16</a>, Children: <a href="#k21">21</a> <a href="#k22">22</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((IMSI IMSI-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA4G 18</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((2 1) (1 0)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 2)
    (enc IMSI-0 SN (ltk SN HN)) (1 0))
  (label 18)
  (parent 16)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k19">Item <a href="#t15">19</a>, Parent: <a href="#k17">17</a>, Children: <a href="#k23">23</a> <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA4G 19</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND SQN-0 data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (2 1)) ((2 2) (0 4)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
      (hash (ltk UE HN) RAND)) (0 4)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 19)
  (parent 17)
  (unrealized (2 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k20">Item <a href="#t15">20</a>, Parent: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA4G 20</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (deflistener
    (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (2 0)) ((2 1) (0 4)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
      (hash (ltk UE HN) RAND)) (0 4)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 20)
  (parent 17)
  (unrealized (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k21">Item <a href="#t15">21</a>, Parent: <a href="#k18">18</a>, Children: <a href="#k25">25</a> <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.810 339.232 45.781 413.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN-0) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((IMSI IMSI-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA4G 21</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN-0) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (3 1)) ((2 1) (1 0)) ((3 2) (0 4)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
      (hash (ltk UE HN) RAND)) (0 4)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 21)
  (parent 18)
  (unrealized (3 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k22">Item <a href="#t15">22</a>, Parent: <a href="#k18">18</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.810 339.232 45.781 413.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((IMSI IMSI-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA4G 22</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN) (HN HN))
  (deflistener
    (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 1) (0 2)) ((1 1) (3 0)) ((2 1) (1 0)) ((3 1) (0 4)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
      (hash (ltk UE HN) RAND)) (0 4)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 22)
  (parent 18)
  (unrealized (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k23">Item <a href="#t15">23</a>, Parent: <a href="#k19">19</a>, Children: <a href="#k27">27</a> <a href="#k28">28</a> <a href="#k29">29</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA4G 23</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (2 1)) ((2 2) (0 4)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 3 1 HomeNetwork 2)
    (enc SQN-0 (hash (ltk UE HN) RAND)) (2 1))
  (label 23)
  (parent 19)
  (unrealized (2 1))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k24">Item <a href="#t15">24</a>, Parent: <a href="#k19">19</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA4G 24</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND SQN-0 data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN-0) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (deflistener (hash (ltk UE HN) RAND))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (3 0)) ((2 2) (0 4))
    ((3 1) (2 1)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-listener (hash (ltk UE HN) RAND))
    (enc SQN-0 (hash (ltk UE HN) RAND)) (2 1))
  (label 24)
  (parent 19)
  (unrealized (2 1) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k25">Item <a href="#t15">25</a>, Parent: <a href="#k21">21</a>, Children: <a href="#k30">30</a> <a href="#k31">31</a> <a href="#k32">32</a> <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.810 339.232 45.781 413.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='339.840' cy='189.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((IMSI IMSI-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA4G 25</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (3 1)) ((2 1) (1 0)) ((3 2) (0 4)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 4 1 HomeNetwork 2)
    (enc SQN-0 (hash (ltk UE HN) RAND)) (3 1))
  (label 25)
  (parent 21)
  (unrealized (3 1))
  (comment &quot;4 in cohort - 4 not yet seen&quot;))</pre>

<p id="k26">Item <a href="#t15">26</a>, Parent: <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='339.840' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN-0) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((IMSI IMSI-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA4G 26</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND SQN-0 data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN-0) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (deflistener (hash (ltk UE HN) RAND))
  (precedes ((1 1) (0 2)) ((1 1) (4 0)) ((2 1) (1 0)) ((3 2) (0 4))
    ((4 1) (3 1)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-listener (hash (ltk UE HN) RAND))
    (enc SQN-0 (hash (ltk UE HN) RAND)) (3 1))
  (label 26)
  (parent 21)
  (unrealized (3 1) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k27">Item <a href="#t15">27</a>, Parent: <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>AKA4G 27 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((0 3) (2 1)) ((1 1) (0 2)) ((2 2) (0 4)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 3 0 ServingNetwork 4)
    (enc SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 27)
  (parent 23)
  (unrealized)
  (shape)
  (maps
    ((0) ((SN SN) (HN HN) (SQN SQN) (RAND RAND) (UE UE) (IMSI IMSI))))
  (origs))</pre>

<p id="k28">Item <a href="#t15">28</a>, Parent: <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA4G 28 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (3 2)) ((2 2) (0 4))
    ((3 3) (2 1)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 4)
    (enc SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 28)
  (parent 23)
  (unrealized)
  (shape)
  (maps
    ((0) ((SN SN) (HN HN) (SQN SQN) (RAND RAND) (UE UE) (IMSI IMSI))))
  (origs))</pre>

<p id="k29">Item <a href="#t15">29</a>, Parent: <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>IMSI</title><circle cx='239.880' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA4G 29</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (deflistener (hash (ltk UE HN) RAND))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (3 0)) ((2 2) (0 4))
    ((3 1) (2 1)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-listener (hash (ltk UE HN) RAND))
    (enc SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 29)
  (parent 23)
  (unrealized (2 1) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k30">Item <a href="#t15">30</a>, Parent: <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='339.840' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((IMSI IMSI-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA4G 30 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (precedes ((0 3) (3 1)) ((1 1) (0 2)) ((2 1) (1 0)) ((3 2) (0 4)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 4 0 ServingNetwork 4)
    (enc SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 30)
  (parent 25)
  (unrealized)
  (shape)
  (maps
    ((0) ((SN SN) (HN HN) (SQN SQN) (RAND RAND) (UE UE) (IMSI IMSI))))
  (origs))</pre>

<p id="k31">Item <a href="#t15">31</a>, Parent: <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='239.880' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA4G 31 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (IMSI IMSI-0) (SQN SQN) (RAND RAND)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (3 2)) ((2 2) (0 4)) ((3 1) (1 0))
    ((3 3) (2 1)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 2 4 ServingNetwork 4)
    (enc SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 31)
  (parent 25)
  (unrealized)
  (shape)
  (maps
    ((0) ((SN SN) (HN HN) (SQN SQN) (RAND RAND) (UE UE) (IMSI IMSI))))
  (origs))</pre>

<p id="k32">Item <a href="#t15">32</a>, Parent: <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-1 SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-1</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='339.840' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-1) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((IMSI IMSI-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA4G 32 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 IMSI-1 text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (IMSI IMSI-1) (SQN SQN) (RAND RAND)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (4 2)) ((2 1) (1 0)) ((3 2) (0 4))
    ((4 3) (3 1)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 4)
    (enc SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 32)
  (parent 25)
  (unrealized)
  (shape)
  (maps
    ((0) ((SN SN) (HN HN) (SQN SQN) (RAND RAND) (UE UE) (IMSI IMSI))))
  (origs))</pre>

<p id="k33">Item <a href="#t15">33</a>, Parent: <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(hash (ltk UE HN) RAND)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>IMSI-0</title><circle cx='339.840' cy='264.960' r='6.000'/>
   </g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>IMSI-0</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI-0 SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((IMSI IMSI-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA4G 33</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI IMSI-0 text) (SQN RAND data) (SN HN UE name))
  (defstrand ServingNetwork 5 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (IMSI IMSI-0) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (deflistener (hash (ltk UE HN) RAND))
  (precedes ((1 1) (0 2)) ((1 1) (4 0)) ((2 1) (1 0)) ((3 2) (0 4))
    ((4 1) (3 1)))
  (fn-of (&quot;ID&quot; (IMSI-0 (cat UE HN))))
  (non-orig (ltk SN HN) (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-listener (hash (ltk UE HN) RAND))
    (enc SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (enc SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
        (hash (ltk UE HN) RAND))
      (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
        (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
  (label 33)
  (parent 25)
  (unrealized (3 1) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t34">Tree <a href="#top">34</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  </svg></div>

<pre>(defprotocol AKA4G basic
  (defrole malSN
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (recv IMSI)
      (send
        (cat RAND (enc SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND)))
      (send
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND))))
    (deflistener IMSI)
    (deflistener (cat RAND (AUTH SQN RAND (ltk UE HN)))))
  (defrole UserEquip
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (send IMSI)
      (recv
        (cat RAND (enc SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN))
    (fn-of (&quot;ID&quot; (IMSI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (recv IMSI) (send (enc IMSI SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (enc SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
            (hash (ltk UE HN) RAND))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
            (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN)))
      (send
        (cat RAND (enc SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
          (hash (ltk UE HN) RAND))))
    (non-orig (ltk SN HN)))
  (defrole HomeNetwork
    (vars (SQN RAND data) (UE SN HN name) (IMSI text))
    (trace (recv (enc IMSI SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (enc SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND
            (hash (ltk UE HN) RAND))
          (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN
            (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))))
    (non-orig (ltk SN HN) (ltk UE HN))
    (uniq-gen RAND)
    (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))))</pre>

<p id="k34">Item <a href="#t34">34</a>, Child: <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='229.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 229.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>AKA4G 34</text>
  </svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND data) (UE SN HN name))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN) (ltk SN HN))
  (uniq-gen RAND)
  (label 34)
  (unrealized (0 0))
  (origs)
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k35">Item <a href="#t34">35</a>, Parent: <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='304.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 304.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>IMSI</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (enc SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN RAND (hash (ltk UE HN) RAND)) (hash (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND) SN (hash SQN (hash (ltk UE HN) RAND))) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc IMSI SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((IMSI IMSI) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>AKA4G 35 (realized)</text></svg></div>

<pre>(defskeleton AKA4G
  (vars (IMSI text) (SQN RAND data) (UE SN HN name))
  (defstrand HomeNetwork 2 (IMSI IMSI) (SQN SQN) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (IMSI IMSI) (SN SN) (HN HN))
  (precedes ((1 1) (0 0)))
  (fn-of (&quot;ID&quot; (IMSI (cat UE HN))))
  (non-orig (ltk UE HN) (ltk SN HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 2)
    (enc IMSI SN (ltk SN HN)) (0 0))
  (label 35)
  (parent 34)
  (unrealized)
  (shape)
  (maps
    ((0) ((SQN SQN) (RAND RAND) (UE UE) (SN SN) (HN HN) (IMSI IMSI))))
  (origs))</pre>

</body>
</html>
