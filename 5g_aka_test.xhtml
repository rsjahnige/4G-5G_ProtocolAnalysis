<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>5G AKA Round 1 suci </title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;5G AKA Round 1 suci &quot;
  (comment &quot;First attempt for modeling 5G AKA&quot;))
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from 5g_aka_test.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t5">5</a> <a href="#t124">124</a>.</p>

<p id="t0">Tree <a href="#top">0</a>.</p>

<div>
 <svg
  class='diagram' width='229.680pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 229.680 154.920' font-size='12.000'>
  <text
   x='189.720' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol AKA5G basic
  (defrole UserEquip
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN) SQN)
    (uniq-gen n)
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig (ltk SN HN))
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN)))))
  (defrole HomeNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
    (uniq-gen RAND)
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='304.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 304.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>AKA5G 0</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI n RAND data) (UE SN HN name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN))
  (uniq-gen n)
  (label 0)
  (unrealized (0 1))
  (origs)
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='304.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 304.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN))</title>
   <circle style='fill: red;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA5G 1</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI n RAND n-0 data) (UE SN HN SN-0 name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (precedes ((1 1) (0 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN-0 HN) (privk HN))
  (uniq-gen n RAND)
  (operation encryption-test (added-strand HomeNetwork 2)
    (hash SQN (hash (ltk UE HN) RAND)) (0 1))
  (label 1)
  (parent 0)
  (unrealized (0 1) (1 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k3">3</a> <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((SUPI SUPI) (n n-0) (SN SN-0) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 2</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI n RAND n-0 data) (UE SN HN SN-0 name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN-0) (HN HN))
  (precedes ((1 1) (0 1)) ((2 1) (1 0)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN-0 HN) (privk HN))
  (uniq-gen n RAND)
  (operation encryption-test (added-strand ServingNetwork 2)
    (enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN)) (1 0))
  (label 2)
  (parent 1)
  (unrealized (0 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>AKA5G 3 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (n RAND SUPI n-0 data) (UE SN HN SN-0 name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (precedes ((1 1) (2 2)) ((2 1) (1 0)) ((2 3) (0 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN-0 HN) (privk HN))
  (uniq-gen n RAND)
  (operation encryption-test (displaced 2 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (0 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN)))
  (label 3)
  (parent 2)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (n n) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (RAND RAND))))
  (origs))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='264.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN-0 (ltk SN-0 HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0 RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN-0 (ltk SN-0 HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g><title>((SUPI SUPI) (n n-0) (SN SN-0) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 4 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI n RAND n-0 n-1 data) (UE SN HN SN-0 name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN-0) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN-0) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN-0) (HN HN))
  (precedes ((1 1) (3 2)) ((2 1) (1 0)) ((3 3) (0 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN-0 HN) (privk HN))
  (uniq-gen n RAND)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (0 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN-0 HN)))
  (label 4)
  (parent 2)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (n n) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (RAND RAND))))
  (origs))</pre>

<p id="t5">Tree <a href="#top">5</a>.</p>

<div>
 <svg
  class='diagram' width='629.040pt' height='4804.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 629.040 4804.920' font-size='12.000'>
  <text
   x='189.720' y='4751.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='139.800' y1='3114.960' x2='189.720' y2='4764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='4676.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k79&quot;, &quot;_self&quot;)'>79</text>
  <line
   x1='439.320' y1='4464.960' x2='489.240' y2='4689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='4601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k123&quot;, &quot;_self&quot;)'>123</text>
  <line
   x1='539.160' y1='4464.960' x2='589.080' y2='4614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='4526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k122&quot;, &quot;_self&quot;)'>122</text>
  <line
   x1='539.160' y1='4464.960' x2='589.080' y2='4539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='4451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k121&quot;, &quot;_self&quot;)'>121</text>
  <line
   x1='539.160' y1='4464.960' x2='589.080' y2='4464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='4376.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k120&quot;, &quot;_self&quot;)'>120</text>
  <line
   x1='539.160' y1='4464.960' x2='589.080' y2='4389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='4301.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k119&quot;, &quot;_self&quot;)'>119</text>
  <line
   x1='539.160' y1='4464.960' x2='589.080' y2='4314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='4451.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k96&quot;, &quot;_self&quot;)'>96</text>
  <line
   x1='489.240' y1='4464.960' x2='539.160' y2='4464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='4451.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k78&quot;, &quot;_self&quot;)'>78</text>
  <line
   x1='439.320' y1='4464.960' x2='489.240' y2='4464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='4226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k77&quot;, &quot;_self&quot;)'>77</text>
  <line
   x1='439.320' y1='4464.960' x2='489.240' y2='4239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='4451.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k55&quot;, &quot;_self&quot;)'>55</text>
  <line
   x1='389.400' y1='4464.960' x2='439.320' y2='4464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='4451.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='339.480' y1='3977.460' x2='389.400' y2='4464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='4151.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k54&quot;, &quot;_self&quot;)'>54</text>
  <line
   x1='389.400' y1='3977.460' x2='439.320' y2='4164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='4076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k95&quot;, &quot;_self&quot;)'>95</text>
  <line
   x1='489.240' y1='3977.460' x2='539.160' y2='4089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='4001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k94&quot;, &quot;_self&quot;)'>94</text>
  <line
   x1='489.240' y1='3977.460' x2='539.160' y2='4014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='3926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k93&quot;, &quot;_self&quot;)'>93</text>
  <line
   x1='489.240' y1='3977.460' x2='539.160' y2='3939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='3851.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k92&quot;, &quot;_self&quot;)'>92</text>
  <line
   x1='489.240' y1='3977.460' x2='539.160' y2='3864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='3963.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k76&quot;, &quot;_self&quot;)'>76</text>
  <line
   x1='439.320' y1='3977.460' x2='489.240' y2='3977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='3963.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k53&quot;, &quot;_self&quot;)'>53</text>
  <line
   x1='389.400' y1='3977.460' x2='439.320' y2='3977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='3776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k52&quot;, &quot;_self&quot;)'>52</text>
  <line
   x1='389.400' y1='3977.460' x2='439.320' y2='3789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='3963.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  <line
   x1='339.480' y1='3977.460' x2='389.400' y2='3977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='3701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k75&quot;, &quot;_self&quot;)'>75</text>
  <line
   x1='439.320' y1='3527.460' x2='489.240' y2='3714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='3626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k118&quot;, &quot;_self&quot;)'>118</text>
  <line
   x1='539.160' y1='3527.460' x2='589.080' y2='3639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='3551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k117&quot;, &quot;_self&quot;)'>117</text>
  <line
   x1='539.160' y1='3527.460' x2='589.080' y2='3564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='3476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k116&quot;, &quot;_self&quot;)'>116</text>
  <line
   x1='539.160' y1='3527.460' x2='589.080' y2='3489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='3401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k115&quot;, &quot;_self&quot;)'>115</text>
  <line
   x1='539.160' y1='3527.460' x2='589.080' y2='3414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='3513.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k91&quot;, &quot;_self&quot;)'>91</text>
  <line
   x1='489.240' y1='3527.460' x2='539.160' y2='3527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='3513.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k74&quot;, &quot;_self&quot;)'>74</text>
  <line
   x1='439.320' y1='3527.460' x2='489.240' y2='3527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='3326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k73&quot;, &quot;_self&quot;)'>73</text>
  <line
   x1='439.320' y1='3527.460' x2='489.240' y2='3339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='3513.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k51&quot;, &quot;_self&quot;)'>51</text>
  <line
   x1='389.400' y1='3527.460' x2='439.320' y2='3527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='3513.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='339.480' y1='3977.460' x2='389.400' y2='3527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='3251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k36&quot;, &quot;_self&quot;)'>36</text>
  <line
   x1='339.480' y1='3977.460' x2='389.400' y2='3264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='3963.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='289.560' y1='3977.460' x2='339.480' y2='3977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='3963.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='239.640' y1='3077.460' x2='289.560' y2='3977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='3176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k72&quot;, &quot;_self&quot;)'>72</text>
  <line
   x1='439.320' y1='3002.460' x2='489.240' y2='3189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='3101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k114&quot;, &quot;_self&quot;)'>114</text>
  <line
   x1='539.160' y1='3002.460' x2='589.080' y2='3114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='3026.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k113&quot;, &quot;_self&quot;)'>113</text>
  <line
   x1='539.160' y1='3002.460' x2='589.080' y2='3039.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='2951.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k112&quot;, &quot;_self&quot;)'>112</text>
  <line
   x1='539.160' y1='3002.460' x2='589.080' y2='2964.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='2876.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k111&quot;, &quot;_self&quot;)'>111</text>
  <line
   x1='539.160' y1='3002.460' x2='589.080' y2='2889.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2988.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k90&quot;, &quot;_self&quot;)'>90</text>
  <line
   x1='489.240' y1='3002.460' x2='539.160' y2='3002.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2988.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k71&quot;, &quot;_self&quot;)'>71</text>
  <line
   x1='439.320' y1='3002.460' x2='489.240' y2='3002.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2801.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k70&quot;, &quot;_self&quot;)'>70</text>
  <line
   x1='439.320' y1='3002.460' x2='489.240' y2='2814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='2988.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k50&quot;, &quot;_self&quot;)'>50</text>
  <line
   x1='389.400' y1='3002.460' x2='439.320' y2='3002.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='2988.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='339.480' y1='2777.460' x2='389.400' y2='3002.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='2726.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k49&quot;, &quot;_self&quot;)'>49</text>
  <line
   x1='389.400' y1='2589.960' x2='439.320' y2='2739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2651.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k89&quot;, &quot;_self&quot;)'>89</text>
  <line
   x1='489.240' y1='2589.960' x2='539.160' y2='2664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2576.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k88&quot;, &quot;_self&quot;)'>88</text>
  <line
   x1='489.240' y1='2589.960' x2='539.160' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2501.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k87&quot;, &quot;_self&quot;)'>87</text>
  <line
   x1='489.240' y1='2589.960' x2='539.160' y2='2514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2576.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k69&quot;, &quot;_self&quot;)'>69</text>
  <line
   x1='439.320' y1='2589.960' x2='489.240' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='2576.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k48&quot;, &quot;_self&quot;)'>48</text>
  <line
   x1='389.400' y1='2589.960' x2='439.320' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='2426.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k47&quot;, &quot;_self&quot;)'>47</text>
  <line
   x1='389.400' y1='2589.960' x2='439.320' y2='2439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='2576.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='339.480' y1='2777.460' x2='389.400' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='2351.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='339.480' y1='2777.460' x2='389.400' y2='2364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='2763.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='289.560' y1='2777.460' x2='339.480' y2='2777.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='2763.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  <line
   x1='239.640' y1='3077.460' x2='289.560' y2='2777.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2276.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k68&quot;, &quot;_self&quot;)'>68</text>
  <line
   x1='439.320' y1='2102.460' x2='489.240' y2='2289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='2201.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k110&quot;, &quot;_self&quot;)'>110</text>
  <line
   x1='539.160' y1='2102.460' x2='589.080' y2='2214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='2126.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k109&quot;, &quot;_self&quot;)'>109</text>
  <line
   x1='539.160' y1='2102.460' x2='589.080' y2='2139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='2051.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k108&quot;, &quot;_self&quot;)'>108</text>
  <line
   x1='539.160' y1='2102.460' x2='589.080' y2='2064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1976.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k107&quot;, &quot;_self&quot;)'>107</text>
  <line
   x1='539.160' y1='2102.460' x2='589.080' y2='1989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2088.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k86&quot;, &quot;_self&quot;)'>86</text>
  <line
   x1='489.240' y1='2102.460' x2='539.160' y2='2102.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2088.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k67&quot;, &quot;_self&quot;)'>67</text>
  <line
   x1='439.320' y1='2102.460' x2='489.240' y2='2102.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1901.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k66&quot;, &quot;_self&quot;)'>66</text>
  <line
   x1='439.320' y1='2102.460' x2='489.240' y2='1914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='2088.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k46&quot;, &quot;_self&quot;)'>46</text>
  <line
   x1='389.400' y1='2102.460' x2='439.320' y2='2102.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='2088.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='339.480' y1='1877.460' x2='389.400' y2='2102.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1826.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k65&quot;, &quot;_self&quot;)'>65</text>
  <line
   x1='439.320' y1='1689.960' x2='489.240' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1751.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k106&quot;, &quot;_self&quot;)'>106</text>
  <line
   x1='539.160' y1='1689.960' x2='589.080' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1676.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k105&quot;, &quot;_self&quot;)'>105</text>
  <line
   x1='539.160' y1='1689.960' x2='589.080' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1601.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k104&quot;, &quot;_self&quot;)'>104</text>
  <line
   x1='539.160' y1='1689.960' x2='589.080' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1676.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k85&quot;, &quot;_self&quot;)'>85</text>
  <line
   x1='489.240' y1='1689.960' x2='539.160' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1676.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k64&quot;, &quot;_self&quot;)'>64</text>
  <line
   x1='439.320' y1='1689.960' x2='489.240' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1526.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k63&quot;, &quot;_self&quot;)'>63</text>
  <line
   x1='439.320' y1='1689.960' x2='489.240' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1676.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k45&quot;, &quot;_self&quot;)'>45</text>
  <line
   x1='389.400' y1='1689.960' x2='439.320' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1676.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='339.480' y1='1877.460' x2='389.400' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1451.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  <line
   x1='339.480' y1='1877.460' x2='389.400' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1863.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='289.560' y1='1877.460' x2='339.480' y2='1877.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1863.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='239.640' y1='3077.460' x2='289.560' y2='1877.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='3063.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='189.720' y1='3077.460' x2='239.640' y2='3077.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='3063.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='139.800' y1='3114.960' x2='189.720' y2='3077.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='3101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='89.880' y1='2402.460' x2='139.800' y2='3114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='1376.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='139.800' y1='714.960' x2='189.720' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k62&quot;, &quot;_self&quot;)'>62</text>
  <line
   x1='439.320' y1='1127.460' x2='489.240' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1226.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k103&quot;, &quot;_self&quot;)'>103</text>
  <line
   x1='539.160' y1='1127.460' x2='589.080' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1151.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k102&quot;, &quot;_self&quot;)'>102</text>
  <line
   x1='539.160' y1='1127.460' x2='589.080' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1076.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k101&quot;, &quot;_self&quot;)'>101</text>
  <line
   x1='539.160' y1='1127.460' x2='589.080' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1001.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k100&quot;, &quot;_self&quot;)'>100</text>
  <line
   x1='539.160' y1='1127.460' x2='589.080' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1113.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k84&quot;, &quot;_self&quot;)'>84</text>
  <line
   x1='489.240' y1='1127.460' x2='539.160' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1113.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k61&quot;, &quot;_self&quot;)'>61</text>
  <line
   x1='439.320' y1='1127.460' x2='489.240' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='926.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k60&quot;, &quot;_self&quot;)'>60</text>
  <line
   x1='439.320' y1='1127.460' x2='489.240' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1113.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='389.400' y1='1127.460' x2='439.320' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1113.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='339.480' y1='902.460' x2='389.400' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='389.400' y1='714.960' x2='439.320' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='776.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k83&quot;, &quot;_self&quot;)'>83</text>
  <line
   x1='489.240' y1='714.960' x2='539.160' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='701.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k82&quot;, &quot;_self&quot;)'>82</text>
  <line
   x1='489.240' y1='714.960' x2='539.160' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='626.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k81&quot;, &quot;_self&quot;)'>81</text>
  <line
   x1='489.240' y1='714.960' x2='539.160' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='701.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k59&quot;, &quot;_self&quot;)'>59</text>
  <line
   x1='439.320' y1='714.960' x2='489.240' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='701.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k42&quot;, &quot;_self&quot;)'>42</text>
  <line
   x1='389.400' y1='714.960' x2='439.320' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='551.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k41&quot;, &quot;_self&quot;)'>41</text>
  <line
   x1='389.400' y1='714.960' x2='439.320' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='701.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='339.480' y1='902.460' x2='389.400' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='476.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='339.480' y1='902.460' x2='389.400' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='888.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='289.560' y1='902.460' x2='339.480' y2='902.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='888.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='239.640' y1='677.460' x2='289.560' y2='902.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k58&quot;, &quot;_self&quot;)'>58</text>
  <line
   x1='439.320' y1='264.960' x2='489.240' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k99&quot;, &quot;_self&quot;)'>99</text>
  <line
   x1='539.160' y1='264.960' x2='589.080' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k98&quot;, &quot;_self&quot;)'>98</text>
  <line
   x1='539.160' y1='264.960' x2='589.080' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k97&quot;, &quot;_self&quot;)'>97</text>
  <line
   x1='539.160' y1='264.960' x2='589.080' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k80&quot;, &quot;_self&quot;)'>80</text>
  <line
   x1='489.240' y1='264.960' x2='539.160' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k57&quot;, &quot;_self&quot;)'>57</text>
  <line
   x1='439.320' y1='264.960' x2='489.240' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k56&quot;, &quot;_self&quot;)'>56</text>
  <line
   x1='439.320' y1='264.960' x2='489.240' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k40&quot;, &quot;_self&quot;)'>40</text>
  <line
   x1='389.400' y1='264.960' x2='439.320' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='213.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='289.560' y1='227.460' x2='339.480' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='213.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  <line
   x1='239.640' y1='677.460' x2='289.560' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='663.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='663.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='139.800' y1='714.960' x2='189.720' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='701.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='89.880' y1='2402.460' x2='139.800' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='2388.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='39.960' y1='2402.460' x2='89.880' y2='2402.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='2388.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  </svg></div>

<pre>(defprotocol AKA5G basic
  (defrole UserEquip
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN) SQN)
    (uniq-gen n)
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig (ltk SN HN))
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN)))))
  (defrole HomeNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
    (uniq-gen RAND)
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))))</pre>

<p id="k5">Item <a href="#t5">5</a>, Child: <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>AKA5G 5</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig (ltk SN HN))
  (label 5)
  (unrealized (0 2) (0 6))
  (origs)
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t5">6</a>, Parent: <a href="#k5">5</a>, Children: <a href="#k7">7</a> <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: red;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA5G 6</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand HomeNetwork 2)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (0 2))
  (label 6)
  (parent 5)
  (unrealized (0 4) (0 6) (1 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t5">7</a>, Parent: <a href="#k6">6</a>, Children: <a href="#k9">9</a> <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA5G 7</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 2 0 ServingNetwork 2)
    (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)) (1 0))
  (label 7)
  (parent 6)
  (unrealized (0 4) (0 6))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k8">Item <a href="#t5">8</a>, Parent: <a href="#k6">6</a>, Children: <a href="#k11">11</a> <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((SUPI SUPI) (n n-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 8</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((2 1) (1 0)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 2)
    (enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN)) (1 0))
  (label 8)
  (parent 6)
  (unrealized (0 4) (0 6))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k9">Item <a href="#t5">9</a>, Parent: <a href="#k7">7</a>, Child: <a href="#k13">13</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 9</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (2 1)) ((2 2) (0 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (0 4))
  (label 9)
  (parent 7)
  (unrealized (0 6) (2 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k10">Item <a href="#t5">10</a>, Parent: <a href="#k7">7</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 10</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (2 0)) ((2 1) (0 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (0 4))
  (label 10)
  (parent 7)
  (unrealized (0 6) (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k11">Item <a href="#t5">11</a>, Parent: <a href="#k8">8</a>, Child: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.810 339.232 45.781 413.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 11</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (3 1)) ((2 1) (1 0)) ((3 2) (0 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (0 4))
  (label 11)
  (parent 8)
  (unrealized (0 6) (3 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k12">Item <a href="#t5">12</a>, Parent: <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.810 339.232 45.781 413.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((SUPI SUPI) (n n-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 12</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 1) (0 2)) ((1 1) (3 0)) ((2 1) (1 0)) ((3 1) (0 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (0 4))
  (label 12)
  (parent 8)
  (unrealized (0 6) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k13">Item <a href="#t5">13</a>, Parent: <a href="#k9">9</a>, Children: <a href="#k15">15</a> <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 186.900 264.960 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 13</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (2 1)) ((2 2) (0 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 1 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (2 1))
  (label 13)
  (parent 9)
  (unrealized (0 6) (2 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k14">Item <a href="#t5">14</a>, Parent: <a href="#k11">11</a>, Children: <a href="#k17">17</a> <a href="#k18">18</a> <a href="#k19">19</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 192.810 339.232 45.781 413.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 14</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (3 1)) ((2 1) (1 0)) ((3 2) (0 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (displaced 4 1 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (3 1))
  (label 14)
  (parent 11)
  (unrealized (0 6) (3 1))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k15">Item <a href="#t5">15</a>, Parent: <a href="#k13">13</a>, Child: <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 15</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((0 3) (2 1)) ((1 1) (0 2)) ((2 2) (0 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 15)
  (parent 13)
  (unrealized (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k16">Item <a href="#t5">16</a>, Parent: <a href="#k13">13</a>, Child: <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 16</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)) ((1 1) (3 2)) ((2 2) (0 4))
    ((3 3) (2 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 16)
  (parent 13)
  (unrealized (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k17">Item <a href="#t5">17</a>, Parent: <a href="#k14">14</a>, Child: <a href="#k22">22</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 17</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (3 1)) ((1 1) (0 2)) ((2 1) (1 0)) ((3 2) (0 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (displaced 4 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 17)
  (parent 14)
  (unrealized (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k18">Item <a href="#t5">18</a>, Parent: <a href="#k14">14</a>, Child: <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 236.880 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 18</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (3 2)) ((2 2) (0 4)) ((3 1) (1 0))
    ((3 3) (2 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 2 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 18)
  (parent 14)
  (unrealized (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k19">Item <a href="#t5">19</a>, Parent: <a href="#k14">14</a>, Child: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 264.960 Q 286.860 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-0) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 19</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 2 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-0) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (0 2)) ((1 1) (4 2)) ((2 1) (1 0)) ((3 2) (0 4))
    ((4 3) (3 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 19)
  (parent 14)
  (unrealized (0 6))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k20">Item <a href="#t5">20</a>, Parent: <a href="#k15">15</a>, Children: <a href="#k25">25</a> <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.320 450.660 44.759 561.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 20</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 1 3 HomeNetwork 4)
    (enc &quot;Success&quot;
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (label 20)
  (parent 15)
  (unrealized (2 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k21">Item <a href="#t5">21</a>, Parent: <a href="#k16">16</a>, Children: <a href="#k27">27</a> <a href="#k28">28</a> <a href="#k29">29</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 192.583 451.118 45.326 562.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 21</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 1 4 HomeNetwork 4)
    (enc &quot;Success&quot;
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (label 21)
  (parent 16)
  (unrealized (3 2))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k22">Item <a href="#t5">22</a>, Parent: <a href="#k17">17</a>, Children: <a href="#k30">30</a> <a href="#k31">31</a> <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 192.583 451.118 45.326 562.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 22</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 4 HomeNetwork 4)
    (enc &quot;Success&quot;
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (label 22)
  (parent 17)
  (unrealized (3 2))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k23">Item <a href="#t5">23</a>, Parent: <a href="#k18">18</a>, Children: <a href="#k33">33</a> <a href="#k34">34</a> <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 192.583 451.118 45.326 562.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 23</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 4 HomeNetwork 4)
    (enc &quot;Success&quot;
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (label 23)
  (parent 18)
  (unrealized (3 2))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k24">Item <a href="#t5">24</a>, Parent: <a href="#k19">19</a>, Children: <a href="#k36">36</a> <a href="#k37">37</a> <a href="#k38">38</a> <a href="#k39">39</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 242.689 451.406 45.578 562.853'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: red;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 24</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 5 HomeNetwork 4)
    (enc &quot;Success&quot;
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))
    (0 6))
  (label 24)
  (parent 19)
  (unrealized (4 2))
  (comment &quot;4 in cohort - 4 not yet seen&quot;))</pre>

<p id="k25">Item <a href="#t5">25</a>, Parent: <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>AKA5G 25 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((0 5) (2 2)) ((1 2) (0 4))
    ((2 1) (0 2)) ((2 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 3 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (2 2))
  (label 25)
  (parent 20)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k26">Item <a href="#t5">26</a>, Parent: <a href="#k20">20</a>, Child: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 26</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-1) (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (2 2))
  (label 26)
  (parent 20)
  (unrealized (3 2) (3 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k27">Item <a href="#t5">27</a>, Parent: <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 27 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((0 5) (3 2)) ((1 2) (0 4)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 4 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (label 27)
  (parent 21)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k28">Item <a href="#t5">28</a>, Parent: <a href="#k21">21</a>, Children: <a href="#k41">41</a> <a href="#k42">42</a> <a href="#k43">43</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 28</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 2 4 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (label 28)
  (parent 21)
  (unrealized (3 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k29">Item <a href="#t5">29</a>, Parent: <a href="#k21">21</a>, Child: <a href="#k44">44</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 29</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-2) (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (label 29)
  (parent 21)
  (unrealized (4 2) (4 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k30">Item <a href="#t5">30</a>, Parent: <a href="#k22">22</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 30 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((0 5) (3 2)) ((1 1) (3 0)) ((2 2) (0 4))
    ((3 1) (0 2)) ((3 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (label 30)
  (parent 22)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k31">Item <a href="#t5">31</a>, Parent: <a href="#k22">22</a>, Child: <a href="#k45">45</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 31</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-1) (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 4 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (label 31)
  (parent 22)
  (unrealized (3 2) (3 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k32">Item <a href="#t5">32</a>, Parent: <a href="#k22">22</a>, Child: <a href="#k46">46</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 32</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-2) (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (label 32)
  (parent 22)
  (unrealized (4 2) (4 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k33">Item <a href="#t5">33</a>, Parent: <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 186.900 452.460 333.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 33 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 5) (3 2)) ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (label 33)
  (parent 23)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k34">Item <a href="#t5">34</a>, Parent: <a href="#k23">23</a>, Children: <a href="#k47">47</a> <a href="#k48">48</a> <a href="#k49">49</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 34</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 3) (0 6))
    ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 2 4 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (label 34)
  (parent 23)
  (unrealized (3 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k35">Item <a href="#t5">35</a>, Parent: <a href="#k23">23</a>, Child: <a href="#k50">50</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 35</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-2) (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (3 2))
  (label 35)
  (parent 23)
  (unrealized (4 2) (4 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k36">Item <a href="#t5">36</a>, Parent: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 236.880 452.460 433.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 36 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 5) (4 2)) ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1))
    ((4 1) (0 2)) ((4 1) (3 2)) ((4 3) (0 6)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 0 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (4 2))
  (label 36)
  (parent 24)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k37">Item <a href="#t5">37</a>, Parent: <a href="#k24">24</a>, Child: <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 37</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-2) (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 5 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (4 2))
  (label 37)
  (parent 24)
  (unrealized (4 2) (4 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k38">Item <a href="#t5">38</a>, Parent: <a href="#k24">24</a>, Children: <a href="#k52">52</a> <a href="#k53">53</a> <a href="#k54">54</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 38</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 5 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (4 2))
  (label 38)
  (parent 24)
  (unrealized (4 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k39">Item <a href="#t5">39</a>, Parent: <a href="#k24">24</a>, Child: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 39</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-3) (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6)) ((5 5) (4 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (4 2))
  (label 39)
  (parent 24)
  (unrealized (5 2) (5 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k40">Item <a href="#t5">40</a>, Parent: <a href="#k26">26</a>, Children: <a href="#k56">56</a> <a href="#k57">57</a> <a href="#k58">58</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 40</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 4 2 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (3 2))
  (label 40)
  (parent 26)
  (unrealized (3 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k41">Item <a href="#t5">41</a>, Parent: <a href="#k28">28</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 414.960 Q 236.880 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 41 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((1 2) (3 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 4 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 41)
  (parent 28)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k42">Item <a href="#t5">42</a>, Parent: <a href="#k28">28</a>, Child: <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 42</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 1)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 42)
  (parent 28)
  (unrealized (4 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k43">Item <a href="#t5">43</a>, Parent: <a href="#k28">28</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 43</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 0)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 1) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 43)
  (parent 28)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k44">Item <a href="#t5">44</a>, Parent: <a href="#k29">29</a>, Children: <a href="#k60">60</a> <a href="#k61">61</a> <a href="#k62">62</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 44</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 5 3 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (4 2))
  (label 44)
  (parent 29)
  (unrealized (4 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k45">Item <a href="#t5">45</a>, Parent: <a href="#k31">31</a>, Children: <a href="#k63">63</a> <a href="#k64">64</a> <a href="#k65">65</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 45</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 2 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (3 2))
  (label 45)
  (parent 31)
  (unrealized (3 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k46">Item <a href="#t5">46</a>, Parent: <a href="#k32">32</a>, Children: <a href="#k66">66</a> <a href="#k67">67</a> <a href="#k68">68</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 46</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 3 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (4 2))
  (label 46)
  (parent 32)
  (unrealized (4 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k47">Item <a href="#t5">47</a>, Parent: <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 414.960 Q 236.880 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 47 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((1 2) (3 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 47)
  (parent 34)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k48">Item <a href="#t5">48</a>, Parent: <a href="#k34">34</a>, Child: <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 48</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (4 1))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 48)
  (parent 34)
  (unrealized (4 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k49">Item <a href="#t5">49</a>, Parent: <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 49</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (4 0))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 1) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 49)
  (parent 34)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k50">Item <a href="#t5">50</a>, Parent: <a href="#k35">35</a>, Children: <a href="#k70">70</a> <a href="#k71">71</a> <a href="#k72">72</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 50</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 3 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (4 2))
  (label 50)
  (parent 35)
  (unrealized (4 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k51">Item <a href="#t5">51</a>, Parent: <a href="#k37">37</a>, Children: <a href="#k73">73</a> <a href="#k74">74</a> <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 51</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 3 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (4 2))
  (label 51)
  (parent 37)
  (unrealized (4 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k52">Item <a href="#t5">52</a>, Parent: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 414.960 Q 336.840 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 52 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((2 2) (4 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 2 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 52)
  (parent 38)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k53">Item <a href="#t5">53</a>, Parent: <a href="#k38">38</a>, Child: <a href="#k76">76</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 53</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 n-1 SUPI n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 1) (5 1)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 53)
  (parent 38)
  (unrealized (5 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k54">Item <a href="#t5">54</a>, Parent: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 54</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 1) (5 0)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 1) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 54)
  (parent 38)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k55">Item <a href="#t5">55</a>, Parent: <a href="#k39">39</a>, Children: <a href="#k77">77</a> <a href="#k78">78</a> <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 55</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6)) ((5 5) (4 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 6 4 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (5 2))
  (label 55)
  (parent 39)
  (unrealized (5 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k56">Item <a href="#t5">56</a>, Parent: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 414.960 Q 236.880 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 56 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((1 2) (3 4))
    ((2 1) (0 2)) ((2 1) (3 2)) ((2 3) (0 6)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 4 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 56)
  (parent 40)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k57">Item <a href="#t5">57</a>, Parent: <a href="#k40">40</a>, Child: <a href="#k80">80</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 57</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 1) (4 1)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 57)
  (parent 40)
  (unrealized (4 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k58">Item <a href="#t5">58</a>, Parent: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 58</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 1) (4 0)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 1) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 58)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k59">Item <a href="#t5">59</a>, Parent: <a href="#k42">42</a>, Children: <a href="#k81">81</a> <a href="#k82">82</a> <a href="#k83">83</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 59</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 1)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 2 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (4 1))
  (label 59)
  (parent 42)
  (unrealized (4 1))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k60">Item <a href="#t5">60</a>, Parent: <a href="#k44">44</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 414.960 Q 286.860 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 60 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((1 2) (4 4)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test (displaced 5 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 60)
  (parent 44)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k61">Item <a href="#t5">61</a>, Parent: <a href="#k44">44</a>, Child: <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 61</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 n-1 n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 61)
  (parent 44)
  (unrealized (5 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k62">Item <a href="#t5">62</a>, Parent: <a href="#k44">44</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 62</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 0)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 1) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 62)
  (parent 44)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k63">Item <a href="#t5">63</a>, Parent: <a href="#k45">45</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 414.960 Q 236.880 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 63 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((1 2) (3 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 4 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 63)
  (parent 45)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k64">Item <a href="#t5">64</a>, Parent: <a href="#k45">45</a>, Child: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 64</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 1)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 64)
  (parent 45)
  (unrealized (4 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k65">Item <a href="#t5">65</a>, Parent: <a href="#k45">45</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 65</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 0)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 1) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (3 4))
  (label 65)
  (parent 45)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k66">Item <a href="#t5">66</a>, Parent: <a href="#k46">46</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 414.960 Q 336.840 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 66 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((2 2) (4 4))
    ((3 1) (0 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 2 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 66)
  (parent 46)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k67">Item <a href="#t5">67</a>, Parent: <a href="#k46">46</a>, Child: <a href="#k86">86</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 67</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 67)
  (parent 46)
  (unrealized (5 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k68">Item <a href="#t5">68</a>, Parent: <a href="#k46">46</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 68</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 1) (5 0)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 1) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 68)
  (parent 46)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k69">Item <a href="#t5">69</a>, Parent: <a href="#k48">48</a>, Children: <a href="#k87">87</a> <a href="#k88">88</a> <a href="#k89">89</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 69</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (4 1))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 2 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (4 1))
  (label 69)
  (parent 48)
  (unrealized (4 1))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k70">Item <a href="#t5">70</a>, Parent: <a href="#k50">50</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 414.960 Q 286.860 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 70 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((1 2) (4 4)) ((2 1) (3 0)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 70)
  (parent 50)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k71">Item <a href="#t5">71</a>, Parent: <a href="#k50">50</a>, Child: <a href="#k90">90</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 71</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 SUPI n-1 n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 71)
  (parent 50)
  (unrealized (5 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k72">Item <a href="#t5">72</a>, Parent: <a href="#k50">50</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 72</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 0)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 1) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 72)
  (parent 50)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k73">Item <a href="#t5">73</a>, Parent: <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 414.960 Q 286.860 377.460 433.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 73 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((1 2) (4 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 5 1 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 73)
  (parent 51)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k74">Item <a href="#t5">74</a>, Parent: <a href="#k51">51</a>, Child: <a href="#k91">91</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 74</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n n-0 n-1 SUPI n-2 n-3 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 74)
  (parent 51)
  (unrealized (5 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k75">Item <a href="#t5">75</a>, Parent: <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 75</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (5 0)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 1) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (4 4))
  (label 75)
  (parent 51)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k76">Item <a href="#t5">76</a>, Parent: <a href="#k53">53</a>, Children: <a href="#k92">92</a> <a href="#k93">93</a> <a href="#k94">94</a> <a href="#k95">95</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 76</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 1) (5 1)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (label 76)
  (parent 53)
  (unrealized (5 1))
  (comment &quot;4 in cohort - 4 not yet seen&quot;))</pre>

<p id="k77">Item <a href="#t5">77</a>, Parent: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 414.960 Q 386.820 377.460 533.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 77 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((2 2) (5 4)) ((3 3) (2 1))
    ((4 1) (0 2)) ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6))
    ((5 5) (4 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 6 2 UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (5 4))
  (label 77)
  (parent 55)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k78">Item <a href="#t5">78</a>, Parent: <a href="#k55">55</a>, Child: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.140 375.660 544.559 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>AKA5G 78</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 1) (6 1)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (5 4))
  (label 78)
  (parent 55)
  (unrealized (6 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k79">Item <a href="#t5">79</a>, Parent: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.140 375.660 544.559 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>AKA5G 79</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 1) (6 0)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 1) (5 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (5 4))
  (label 79)
  (parent 55)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k80">Item <a href="#t5">80</a>, Parent: <a href="#k57">57</a>, Children: <a href="#k97">97</a> <a href="#k98">98</a> <a href="#k99">99</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 80</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 1) (4 1)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 2 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (4 1))
  (label 80)
  (parent 57)
  (unrealized (4 1))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k81">Item <a href="#t5">81</a>, Parent: <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 81 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (4 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 81)
  (parent 59)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k82">Item <a href="#t5">82</a>, Parent: <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 339.960 Q 386.820 339.960 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 82 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 3) (1 1)) ((3 3) (4 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 82)
  (parent 59)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k83">Item <a href="#t5">83</a>, Parent: <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 386.820 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 83 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (5 2)) ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)) ((5 3) (4 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 83)
  (parent 59)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k84">Item <a href="#t5">84</a>, Parent: <a href="#k61">61</a>, Children: <a href="#k100">100</a> <a href="#k101">101</a> <a href="#k102">102</a> <a href="#k103">103</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 84</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (label 84)
  (parent 61)
  (unrealized (5 1))
  (comment &quot;4 in cohort - 4 not yet seen&quot;))</pre>

<p id="k85">Item <a href="#t5">85</a>, Parent: <a href="#k64">64</a>, Children: <a href="#k104">104</a> <a href="#k105">105</a> <a href="#k106">106</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.220 375.660 344.639 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 336.840 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960' style='text-anchor: middle;'>AKA5G 85</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (4 1)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 2 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (4 1))
  (label 85)
  (parent 64)
  (unrealized (4 1))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k86">Item <a href="#t5">86</a>, Parent: <a href="#k67">67</a>, Children: <a href="#k107">107</a> <a href="#k108">108</a> <a href="#k109">109</a> <a href="#k110">110</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 86</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (label 86)
  (parent 67)
  (unrealized (5 1))
  (comment &quot;4 in cohort - 4 not yet seen&quot;))</pre>

<p id="k87">Item <a href="#t5">87</a>, Parent: <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 87 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (4 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 87)
  (parent 69)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k88">Item <a href="#t5">88</a>, Parent: <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 339.960 Q 386.820 339.960 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 88 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 3) (0 6))
    ((3 1) (2 0)) ((3 3) (1 1)) ((3 3) (4 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 88)
  (parent 69)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k89">Item <a href="#t5">89</a>, Parent: <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 386.820 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 89 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (5 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (1 1)) ((3 5) (2 2))
    ((4 2) (3 4)) ((5 3) (4 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 89)
  (parent 69)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k90">Item <a href="#t5">90</a>, Parent: <a href="#k71">71</a>, Children: <a href="#k111">111</a> <a href="#k112">112</a> <a href="#k113">113</a> <a href="#k114">114</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 90</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (label 90)
  (parent 71)
  (unrealized (5 1))
  (comment &quot;4 in cohort - 4 not yet seen&quot;))</pre>

<p id="k91">Item <a href="#t5">91</a>, Parent: <a href="#k74">74</a>, Children: <a href="#k115">115</a> <a href="#k116">116</a> <a href="#k117">117</a> <a href="#k118">118</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.180 375.660 444.599 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 436.800 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>AKA5G 91</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (5 1)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 3 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (5 1))
  (label 91)
  (parent 74)
  (unrealized (5 1))
  (comment &quot;4 in cohort - 4 not yet seen&quot;))</pre>

<p id="k92">Item <a href="#t5">92</a>, Parent: <a href="#k76">76</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 92 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (5 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 92)
  (parent 76)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k93">Item <a href="#t5">93</a>, Parent: <a href="#k76">76</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 392.820 152.460 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.880 302.460 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 386.820 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 93 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 n-2 SUPI n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2)) ((2 1) (5 2))
    ((2 3) (0 6)) ((3 3) (1 1)) ((3 5) (2 2)) ((4 2) (3 4))
    ((5 1) (2 0)) ((5 3) (4 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 1 6 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 93)
  (parent 76)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k94">Item <a href="#t5">94</a>, Parent: <a href="#k76">76</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 339.960 Q 486.780 339.960 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 94 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 3) (0 6)) ((4 3) (2 1)) ((4 3) (5 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 94)
  (parent 76)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k95">Item <a href="#t5">95</a>, Parent: <a href="#k76">76</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 342.840 302.460 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>AKA5G 95 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2)) ((3 1) (4 2))
    ((3 1) (6 2)) ((3 3) (0 6)) ((4 3) (2 1)) ((4 5) (3 2))
    ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 95)
  (parent 76)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k96">Item <a href="#t5">96</a>, Parent: <a href="#k78">78</a>, Children: <a href="#k119">119</a> <a href="#k120">120</a> <a href="#k121">121</a> <a href="#k122">122</a> <a href="#k123">123</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.140 375.660 544.559 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 536.760 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>AKA5G 96</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 1) (6 1)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (displaced 7 4 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (6 1))
  (label 96)
  (parent 78)
  (unrealized (6 1))
  (comment &quot;5 in cohort - 5 not yet seen&quot;))</pre>

<p id="k97">Item <a href="#t5">97</a>, Parent: <a href="#k80">80</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 97 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((0 3) (4 1)) ((1 2) (0 4))
    ((2 1) (0 2)) ((2 1) (3 2)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 97)
  (parent 80)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k98">Item <a href="#t5">98</a>, Parent: <a href="#k80">80</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 386.820 339.960 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 98 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 3) (4 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (displaced 5 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 98)
  (parent 80)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k99">Item <a href="#t5">99</a>, Parent: <a href="#k80">80</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 386.820 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 99 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 0)) ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 1) (5 2)) ((2 3) (0 6)) ((3 5) (2 2))
    ((4 2) (3 4)) ((5 3) (4 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-2)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 99)
  (parent 80)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k100">Item <a href="#t5">100</a>, Parent: <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 100 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((0 3) (5 1)) ((1 2) (0 4)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 100)
  (parent 84)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k101">Item <a href="#t5">101</a>, Parent: <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 339.960 Q 386.820 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 101 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((2 3) (5 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (displaced 6 2 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 101)
  (parent 84)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k102">Item <a href="#t5">102</a>, Parent: <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 486.780 339.960 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 102 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (5 1))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 102)
  (parent 84)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k103">Item <a href="#t5">103</a>, Parent: <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>AKA5G 103 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
    (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (3 0)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 103)
  (parent 84)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k104">Item <a href="#t5">104</a>, Parent: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 236.880 302.460 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 104 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((0 3) (4 1)) ((1 2) (0 4)) ((2 1) (0 2))
    ((2 1) (3 2)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 104)
  (parent 85)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k105">Item <a href="#t5">105</a>, Parent: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 386.820 339.960 433.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 105 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 3) (0 6)) ((3 1) (2 0)) ((3 3) (4 1)) ((3 5) (2 2))
    ((4 2) (3 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 5 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 105)
  (parent 85)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k106">Item <a href="#t5">106</a>, Parent: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 386.820 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 106 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (5 2)) ((2 3) (0 6)) ((3 1) (2 0)) ((3 5) (2 2))
    ((4 2) (3 4)) ((5 3) (4 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (4 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 106)
  (parent 85)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k107">Item <a href="#t5">107</a>, Parent: <a href="#k86">86</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 107 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((0 3) (5 1)) ((1 1) (3 0)) ((2 2) (0 4))
    ((3 1) (0 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 107)
  (parent 86)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k108">Item <a href="#t5">108</a>, Parent: <a href="#k86">86</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 392.820 152.460 245.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 286.860 264.960 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 264.960 Q 386.820 227.460 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 108 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 n-2 SUPI n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (1 1)) ((1 2) (0 4)) ((2 1) (0 2)) ((2 1) (3 2))
    ((2 1) (5 2)) ((2 3) (0 6)) ((3 5) (2 2)) ((4 2) (3 4))
    ((5 1) (2 0)) ((5 3) (4 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-2)
  (operation encryption-test (displaced 1 6 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 108)
  (parent 86)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k109">Item <a href="#t5">109</a>, Parent: <a href="#k86">86</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 486.780 339.960 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 109 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (5 1)) ((4 5) (3 2))
    ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 109)
  (parent 86)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k110">Item <a href="#t5">110</a>, Parent: <a href="#k86">86</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-1) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>AKA5G 110 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-1) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (2 1)) ((1 1) (3 0)) ((2 2) (0 4)) ((3 1) (0 2))
    ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 110)
  (parent 86)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k111">Item <a href="#t5">111</a>, Parent: <a href="#k90">90</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 111 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (5 1)) ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 111)
  (parent 90)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k112">Item <a href="#t5">112</a>, Parent: <a href="#k90">90</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 339.960 Q 386.820 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 112 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((2 3) (5 1))
    ((3 1) (0 2)) ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 2 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 112)
  (parent 90)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k113">Item <a href="#t5">113</a>, Parent: <a href="#k90">90</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 486.780 339.960 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 113 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 3) (5 1))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 113)
  (parent 90)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k114">Item <a href="#t5">114</a>, Parent: <a href="#k90">90</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>AKA5G 114 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 1) (3 0)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6))
    ((4 5) (3 2)) ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 114)
  (parent 90)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k115">Item <a href="#t5">115</a>, Parent: <a href="#k91">91</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 286.860 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 115 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (5 1)) ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 115)
  (parent 91)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k116">Item <a href="#t5">116</a>, Parent: <a href="#k91">91</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 339.960 Q 386.820 302.460 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 116 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((2 3) (5 1)) ((3 1) (0 2))
    ((3 1) (2 2)) ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 2 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 116)
  (parent 91)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k117">Item <a href="#t5">117</a>, Parent: <a href="#k91">91</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 486.780 339.960 533.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>AKA5G 117 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 data) (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 3) (0 6)) ((4 1) (3 0)) ((4 3) (5 1))
    ((4 5) (3 2)) ((5 2) (4 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 6 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 117)
  (parent 91)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k118">Item <a href="#t5">118</a>, Parent: <a href="#k91">91</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>AKA5G 118 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 SUPI n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6)) ((4 1) (3 0))
    ((4 5) (3 2)) ((5 2) (4 4)) ((6 3) (5 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (5 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 118)
  (parent 91)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k119">Item <a href="#t5">119</a>, Parent: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 336.840 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>AKA5G 119 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 3) (6 1)) ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1))
    ((4 1) (0 2)) ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (displaced 7 0 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 119)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k120">Item <a href="#t5">120</a>, Parent: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 492.780 152.460 345.840 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 386.820 264.960 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 264.960 Q 486.780 227.460 633.720 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-4 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>AKA5G 120 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 n-1 n-2 n-3 SUPI n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 2) (0 4)) ((2 3) (1 1)) ((3 1) (0 2)) ((3 1) (2 2))
    ((3 1) (4 2)) ((3 1) (6 2)) ((3 3) (0 6)) ((4 5) (3 2))
    ((5 2) (4 4)) ((6 1) (3 0)) ((6 3) (5 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-3)
  (operation encryption-test (displaced 1 7 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 120)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k121">Item <a href="#t5">121</a>, Parent: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 339.960 Q 486.780 302.460 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>AKA5G 121 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((3 3) (6 1))
    ((4 1) (0 2)) ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (displaced 7 3 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 121)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k122">Item <a href="#t5">122</a>, Parent: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 586.740 339.960 633.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>AKA5G 122 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 3) (0 6)) ((5 3) (6 1))
    ((5 5) (4 2)) ((6 2) (5 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (displaced 7 5 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 122)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="k123">Item <a href="#t5">123</a>, Parent: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-5 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-5 (pubk HN))</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-4 (pubk HN))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 492.780 489.960 445.800 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-3 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-3 (pubk HN))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 564.960 Q 242.880 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='439.800' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='489.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 242.880 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 486.780 264.960 533.760 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 439.800 264.960 Q 586.740 227.460 733.680 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-5) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='739.680' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='639.720' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g><title>((SUPI SUPI) (n n-2) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>AKA5G 123 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n SUPI n-0 n-1 n-2 n-3 n-4 n-5 data)
    (SN HN UE name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n-2) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-3)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-4)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-5)
    (UE UE) (SN SN) (HN HN))
  (precedes ((1 1) (4 0)) ((2 2) (0 4)) ((3 3) (2 1)) ((4 1) (0 2))
    ((4 1) (3 2)) ((4 1) (5 2)) ((4 1) (7 2)) ((4 3) (0 6))
    ((5 5) (4 2)) ((6 2) (5 4)) ((7 3) (6 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
  (uniq-gen RAND n-0 n-4)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (6 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 123)
  (parent 96)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SN SN) (HN HN) (SUPI SUPI) (RAND RAND) (n n) (UE UE)
        (SQN SQN))))
  (origs))</pre>

<p id="t124">Tree <a href="#top">124</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 529.920' font-size='12.000'>
  <text
   x='239.640' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k133&quot;, &quot;_self&quot;)'>133</text>
  <line
   x1='189.720' y1='377.460' x2='239.640' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='401.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k140&quot;, &quot;_self&quot;)'>140</text>
  <line
   x1='289.560' y1='339.960' x2='339.480' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k139&quot;, &quot;_self&quot;)'>139</text>
  <line
   x1='289.560' y1='339.960' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k138&quot;, &quot;_self&quot;)'>138</text>
  <line
   x1='289.560' y1='339.960' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='326.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k135&quot;, &quot;_self&quot;)'>135</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k132&quot;, &quot;_self&quot;)'>132</text>
  <line
   x1='189.720' y1='377.460' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k129&quot;, &quot;_self&quot;)'>129</text>
  <line
   x1='139.800' y1='377.460' x2='189.720' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k127&quot;, &quot;_self&quot;)'>127</text>
  <line
   x1='89.880' y1='264.960' x2='139.800' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k131&quot;, &quot;_self&quot;)'>131</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k137&quot;, &quot;_self&quot;)'>137</text>
  <line
   x1='289.560' y1='77.460' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k136&quot;, &quot;_self&quot;)'>136</text>
  <line
   x1='289.560' y1='77.460' x2='339.480' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k134&quot;, &quot;_self&quot;)'>134</text>
  <line
   x1='239.640' y1='77.460' x2='289.560' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k130&quot;, &quot;_self&quot;)'>130</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k128&quot;, &quot;_self&quot;)'>128</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k126&quot;, &quot;_self&quot;)'>126</text>
  <line
   x1='89.880' y1='264.960' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k125&quot;, &quot;_self&quot;)'>125</text>
  <line
   x1='39.960' y1='264.960' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k124&quot;, &quot;_self&quot;)'>124</text>
  </svg></div>

<pre>(defprotocol AKA5G basic
  (defrole UserEquip
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (send (enc SUPI n (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN) SQN)
    (uniq-gen n)
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc SUPI n (pubk HN)))
      (send (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (recv
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (recv
        (enc &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig (ltk SN HN))
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN)))))
  (defrole HomeNetwork
    (vars (SUPI RAND n data) (UE SN HN name) (SQN text))
    (trace (recv (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)))
      (send
        (enc RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
      (recv
        (enc
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) (ltk SN HN)))
      (send
        (enc &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI
          (ltk SN HN))))
    (non-orig SQN (ltk SN HN) (ltk UE HN) (privk HN))
    (uniq-gen RAND)
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))))</pre>

<p id="k124">Item <a href="#t124">124</a>, Child: <a href="#k125">125</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>AKA5G 124</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (label 124)
  (unrealized (0 0) (0 2))
  (origs)
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k125">Item <a href="#t124">125</a>, Parent: <a href="#k124">124</a>, Children: <a href="#k126">126</a> <a href="#k127">127</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>((SUPI SUPI) (n n) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA5G 125</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (precedes ((1 1) (0 0)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 2)
    (enc (enc SUPI n (pubk HN)) SN (ltk SN HN)) (0 0))
  (label 125)
  (parent 124)
  (unrealized (0 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k126">Item <a href="#t124">126</a>, Parent: <a href="#k125">125</a>, Child: <a href="#k128">128</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA5G 126</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((1 1) (0 0)) ((1 5) (0 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 1 2 ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (0 2))
  (label 126)
  (parent 125)
  (unrealized (1 2) (1 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k127">Item <a href="#t124">127</a>, Parent: <a href="#k125">125</a>, Child: <a href="#k129">129</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g><title>((SUPI SUPI) (n n) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 127</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (SUPI RAND n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN-0) (SUPI SUPI) (RAND RAND)
    (n n-0) (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((1 1) (0 0)) ((2 5) (0 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand ServingNetwork 6)
    (enc
      (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
        RAND (hash (ltk UE HN) RAND)) (ltk SN HN)) (0 2))
  (label 127)
  (parent 125)
  (unrealized (2 2) (2 4))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k128">Item <a href="#t124">128</a>, Parent: <a href="#k126">126</a>, Children: <a href="#k130">130</a> <a href="#k131">131</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='89.940' y='39.960' style='text-anchor: middle;'>AKA5G 128</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((1 1) (0 0)) ((1 5) (0 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 2 0 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (1 2))
  (label 128)
  (parent 126)
  (unrealized (1 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k129">Item <a href="#t124">129</a>, Parent: <a href="#k127">127</a>, Children: <a href="#k132">132</a> <a href="#k133">133</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g><title>((SUPI SUPI) (n n) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 129</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((1 1) (0 0)) ((2 5) (0 2)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 3 0 HomeNetwork 2)
    (enc RAND
      (cat (hash SQN-0 (hash (ltk UE HN) RAND))
        (hash SQN-0 RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)) (2 2))
  (label 129)
  (parent 127)
  (unrealized (2 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k130">Item <a href="#t124">130</a>, Parent: <a href="#k128">128</a>, Child: <a href="#k134">134</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.300 375.660 144.719 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 130</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (RAND SUPI n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((0 1) (2 1)) ((1 1) (0 0)) ((1 5) (0 2))
    ((2 2) (1 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (1 4))
  (label 130)
  (parent 128)
  (unrealized (2 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k131">Item <a href="#t124">131</a>, Parent: <a href="#k128">128</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.300 375.660 144.719 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 131</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (1 2)) ((0 1) (2 0)) ((1 1) (0 0)) ((1 5) (0 2))
    ((2 1) (1 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (1 4))
  (label 131)
  (parent 128)
  (unrealized (2 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k132">Item <a href="#t124">132</a>, Parent: <a href="#k129">129</a>, Child: <a href="#k135">135</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.260 375.660 244.679 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN-0 (hash (ltk UE HN) RAND)) (hash SQN-0 RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g><title>((SUPI SUPI) (n n) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 132</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN SQN-0 text) (SUPI RAND n n-0 n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN-0) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((0 1) (3 1)) ((1 1) (0 0)) ((2 5) (0 2))
    ((3 2) (2 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN SQN-0 (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (added-strand UserEquip 3)
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (2 4))
  (label 132)
  (parent 129)
  (unrealized (3 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k133">Item <a href="#t124">133</a>, Parent: <a href="#k129">129</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.260 375.660 244.679 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g><title>((SUPI SUPI) (n n) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 133</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (deflistener
    (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)))
  (precedes ((0 1) (2 2)) ((0 1) (3 0)) ((1 1) (0 0)) ((2 5) (0 2))
    ((3 1) (2 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND)
  (operation encryption-test
    (added-listener
      (cat (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
        (hash (ltk UE HN) RAND)))
    (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND
      (hash (ltk UE HN) RAND)) (2 4))
  (label 133)
  (parent 129)
  (unrealized (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k134">Item <a href="#t124">134</a>, Parent: <a href="#k130">130</a>, Children: <a href="#k136">136</a> <a href="#k137">137</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 192.300 375.660 144.719 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='139.920' y='39.960' style='text-anchor: middle;'>AKA5G 134</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((0 1) (2 1)) ((1 1) (0 0)) ((1 5) (0 2))
    ((2 2) (1 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 0 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (2 1))
  (label 134)
  (parent 130)
  (unrealized (2 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k135">Item <a href="#t124">135</a>, Parent: <a href="#k132">132</a>, Children: <a href="#k138">138</a> <a href="#k139">139</a> <a href="#k140">140</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.260 375.660 244.679 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g><title>((SUPI SUPI) (n n) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='189.900' y='39.960' style='text-anchor: middle;'>AKA5G 135</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((0 1) (3 1)) ((1 1) (0 0)) ((2 5) (0 2))
    ((3 2) (2 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (displaced 4 0 HomeNetwork 2)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (3 1))
  (label 135)
  (parent 132)
  (unrealized (3 1))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k136">Item <a href="#t124">136</a>, Parent: <a href="#k134">134</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 186.900 339.960 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>AKA5G 136 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((1 1) (0 0)) ((1 3) (2 1)) ((1 5) (0 2))
    ((2 2) (1 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 3 1 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 136)
  (parent 134)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n))))
  (origs))</pre>

<p id="k137">Item <a href="#t124">137</a>, Parent: <a href="#k134">134</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 137 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI n n-0 n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((0 1) (3 2)) ((1 1) (0 0)) ((1 5) (0 2))
    ((2 2) (1 4)) ((3 3) (2 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (2 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 137)
  (parent 134)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n))))
  (origs))</pre>

<p id="k138">Item <a href="#t124">138</a>, Parent: <a href="#k135">135</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-1 (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 138 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND n n-0 SUPI n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (1 2)) ((0 1) (3 2)) ((1 5) (0 2)) ((2 2) (1 4))
    ((3 1) (0 0)) ((3 3) (2 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-0)
  (operation encryption-test (displaced 1 4 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 138)
  (parent 135)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n-1))))
  (origs))</pre>

<p id="k139">Item <a href="#t124">139</a>, Parent: <a href="#k135">135</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 286.860 339.960 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g><title>((SUPI SUPI) (n n) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>AKA5G 139 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 n-1 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((1 1) (0 0)) ((2 3) (3 1)) ((2 5) (0 2))
    ((3 2) (2 4)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (displaced 4 2 ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 139)
  (parent 135)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n))))
  (origs))</pre>

<p id="k140">Item <a href="#t124">140</a>, Parent: <a href="#k135">135</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-2 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-2 (pubk HN))</title>
   <circle style='fill: blue;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(enc SUPI n-1 (pubk HN))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n-0 (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n-0 (pubk HN))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI n (pubk HN))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI (ltk SN HN))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc (enc SUPI n (pubk HN)) SN (ltk SN HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='439.800' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g><title>((SUPI SUPI) (n n) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (n n) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>AKA5G 140 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND n n-0 n-1 n-2 data) (UE SN HN name))
  (defstrand HomeNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 2 (SUPI SUPI) (n n) (SN SN) (HN HN))
  (defstrand ServingNetwork 6 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-0)
    (UE UE) (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-1)
    (UE UE) (SN SN) (HN HN))
  (defstrand ServingNetwork 4 (SQN SQN) (SUPI SUPI) (RAND RAND) (n n-2)
    (UE UE) (SN SN) (HN HN))
  (precedes ((0 1) (2 2)) ((0 1) (4 2)) ((1 1) (0 0)) ((2 5) (0 2))
    ((3 2) (2 4)) ((4 3) (3 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN) (ltk SN HN) (privk HN))
  (uniq-gen RAND n-1)
  (operation encryption-test (added-strand ServingNetwork 4)
    (hash SQN (hash (ltk UE HN) RAND)) (3 1)
    (enc RAND
      (cat (hash SQN (hash (ltk UE HN) RAND))
        (hash SQN RAND (ltk UE HN)))
      (hash
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)) RAND) (ltk SN HN)))
  (label 140)
  (parent 135)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN) (SQN SQN)
        (n n))))
  (origs))</pre>

</body>
</html>
