<?xml version="1.0"?>
<!-- CPSA 3.6.6 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>5G AKA Round 1 suci </title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;Extracted shapes&quot;)
(herald &quot;5G AKA Round 1 suci &quot;
  (comment &quot;First attempt for modeling 5G AKA&quot;))
(comment &quot;CPSA 3.6.6&quot;)
(comment &quot;All input read from 5g_aka_test.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t3">3</a> <a href="#t4">4</a>.</p>

<p id="t0">Tree <a href="#top">0</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol AKA5G basic
  (defrole UserEquip
    (vars (SUPI RAND data) (UE SN HN name) (SQN text))
    (trace (send (enc SUPI (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN))
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SUPI RAND data) (UE SN HN name) (SQN text))
    (trace (recv (enc SUPI (pubk HN)))
      (send (cat (enc SUPI (pubk HN)) SN))
      (recv
        (cat RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (recv
        (cat &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI))))
  (defrole HomeNetwork
    (vars (SUPI RAND data) (UE SN HN name) (SQN text))
    (trace (recv (cat (enc SUPI (pubk HN)) SN))
      (init
        (cat
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) SUPI))
      (send
        (cat RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND)))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (cat &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI)))
    (non-orig SQN (ltk UE HN))
    (uniq-gen RAND)
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='304.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 304.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI (pubk HN))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>AKA5G 0</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND data) (UE HN SN name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig (ltk UE HN))
  (label 0)
  (unrealized (0 1))
  (origs)
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 379.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0 RAND (hash (ltk UE HN) RAND)) RAND))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN-0 RAND (hash (ltk UE HN) RAND)) SUPI)</title>
   <circle style='fill: gray;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat (enc SUPI (pubk HN)) SN-0)</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI (pubk HN))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE) (SN SN-0) (HN HN))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>AKA5G 1 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (RAND SUPI data) (UE HN SN SN-0 name))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand HomeNetwork 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE)
    (SN SN-0) (HN HN))
  (precedes ((1 2) (0 1)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (added-strand HomeNetwork 3)
    (hash SQN (hash (ltk UE HN) RAND)) (0 1))
  (label 1)
  (parent 0)
  (unrealized)
  (shape)
  (maps
    ((0) ((SUPI SUPI) (UE UE) (HN HN) (SQN SQN) (RAND RAND) (SN SN))))
  (origs))</pre>

<p id="t3">Tree <a href="#top">3</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 79.920' font-size='12.000'>
  <text
   x='39.960' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  </svg></div>

<pre>(defprotocol AKA5G basic
  (defrole UserEquip
    (vars (SUPI RAND data) (UE SN HN name) (SQN text))
    (trace (send (enc SUPI (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN))
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SUPI RAND data) (UE SN HN name) (SQN text))
    (trace (recv (enc SUPI (pubk HN)))
      (send (cat (enc SUPI (pubk HN)) SN))
      (recv
        (cat RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (recv
        (cat &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI))))
  (defrole HomeNetwork
    (vars (SUPI RAND data) (UE SN HN name) (SQN text))
    (trace (recv (cat (enc SUPI (pubk HN)) SN))
      (init
        (cat
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) SUPI))
      (send
        (cat RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND)))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (cat &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI)))
    (non-orig SQN (ltk UE HN))
    (uniq-gen RAND)
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))))</pre>

<p id="k3">Item <a href="#t3">3</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(cat &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI)</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat (enc SUPI (pubk HN)) SN)</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(enc SUPI (pubk HN))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>ServingNetwork</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>AKA5G 3 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND data) (SN UE HN name))
  (defstrand ServingNetwork 7 (SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (label 3)
  (unrealized)
  (shape)
  (maps
    ((0) ((SN SN) (SUPI SUPI) (RAND RAND) (UE UE) (HN HN) (SQN SQN))))
  (origs))</pre>

<p id="t4">Tree <a href="#top">4</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  </svg></div>

<pre>(defprotocol AKA5G basic
  (defrole UserEquip
    (vars (SUPI RAND data) (UE SN HN name) (SQN text))
    (trace (send (enc SUPI (pubk HN)))
      (recv
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND))))
    (non-orig (ltk UE HN))
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN)))))
  (defrole ServingNetwork
    (vars (SUPI RAND data) (UE SN HN name) (SQN text))
    (trace (recv (enc SUPI (pubk HN)))
      (send (cat (enc SUPI (pubk HN)) SN))
      (recv
        (cat RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND)))
      (send
        (cat RAND (hash SQN (hash (ltk UE HN) RAND))
          (hash SQN RAND (ltk UE HN))))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (recv
        (cat &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI))))
  (defrole HomeNetwork
    (vars (SUPI RAND data) (UE SN HN name) (SQN text))
    (trace (recv (cat (enc SUPI (pubk HN)) SN))
      (init
        (cat
          (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
            RAND (hash (ltk UE HN) RAND)) SUPI))
      (send
        (cat RAND
          (cat (hash SQN (hash (ltk UE HN) RAND))
            (hash SQN RAND (ltk UE HN)))
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN RAND (hash (ltk UE HN) RAND)) RAND)))
      (recv
        (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN
          RAND (hash (ltk UE HN) RAND)))
      (send
        (cat &quot;Success&quot;
          (hash
            (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND))
              SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI)))
    (non-orig SQN (ltk UE HN))
    (uniq-gen RAND)
    (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))))</pre>

<p id="k4">Item <a href="#t4">4</a>, Child: <a href="#k7">7</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(cat &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI)</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) SUPI)</title>
   <circle style='fill: gray;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat (enc SUPI (pubk HN)) SN)</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='39.960' y='39.960' style='text-anchor: middle;'>AKA5G 4</text>
  </svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND data) (UE HN SN name))
  (defstrand HomeNetwork 5 (SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN))
  (uniq-gen RAND)
  (label 4)
  (unrealized (0 3))
  (origs)
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t4">7</a>, Parent: <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat RAND (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(enc SUPI (pubk HN))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;Success&quot; (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN (hash SQN (hash (ltk UE HN) RAND))) SN) SUPI)</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat RAND (cat (hash SQN (hash (ltk UE HN) RAND)) (hash SQN RAND (ltk UE HN))) (hash (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) RAND))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (hash (cat (hash (ltk UE HN) RAND) (hash (ltk UE HN) RAND)) SN RAND (hash (ltk UE HN) RAND)) SUPI)</title>
   <circle style='fill: gray;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat (enc SUPI (pubk HN)) SN)</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>UserEquip</text>
   </g>
  <g>
   <title>((SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE) (SN SN) (HN HN))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>HomeNetwork</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>AKA5G 7 (realized)</text></svg></div>

<pre>(defskeleton AKA5G
  (vars (SQN text) (SUPI RAND data) (UE HN SN name))
  (defstrand HomeNetwork 5 (SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (defstrand UserEquip 3 (SQN SQN) (SUPI SUPI) (RAND RAND) (UE UE)
    (SN SN) (HN HN))
  (precedes ((0 2) (1 1)) ((1 2) (0 3)))
  (fn-of (&quot;ID&quot; (SUPI (cat UE HN))))
  (non-orig SQN (ltk UE HN))
  (uniq-gen RAND)
  (operation encryption-test (displaced 2 0 HomeNetwork 3)
    (hash SQN-0 (hash (ltk UE HN) RAND)) (1 1))
  (label 7)
  (parent 4)
  (unrealized)
  (shape)
  (maps
    ((0) ((SUPI SUPI) (RAND RAND) (UE UE) (HN HN) (SN SN) (SQN SQN))))
  (origs))</pre>

</body>
</html>
